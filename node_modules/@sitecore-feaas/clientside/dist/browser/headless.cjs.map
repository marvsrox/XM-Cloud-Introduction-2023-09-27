{
  "version": 3,
  "sources": ["../../src/headless.ts", "../../src/utils/promise.ts", "../../src/components/FEAASBase.tsx", "../../src/components/FEAASElement.tsx", "../../node_modules/jsonpath-plus/dist/index-browser-esm.js", "../../src/dom/data.ts", "../../src/dom/html.ts", "../../src/dom/scripts.ts", "../../src/dom/rendering.ts", "../../src/fetch.ts", "../../src/cdn.ts", "../../src/dom/stylesheet.ts", "../../src/dom/component.ts", "../../src/components/FEAASComponent.tsx", "../../src/components/FEAASLoader.tsx", "../../src/components/FEAASStylesheet.tsx"],
  "sourcesContent": ["/**\n * Simplified build of clientside that does not rely on any Frontend UI (like pickers). It refered from Frontend app to\n * avoid circular dependency. Regular clientside build entry point is in ui/index.ts\n */\n\nimport FEAASElement from './components/FEAASElement.js'\n\nexport * from './dom/rendering.js'\nexport * from './dom/data.js'\nexport * from './dom/scripts.js'\nexport * from './dom/stylesheet.js'\nexport * from './dom/component.js'\nexport * from './fetch.js'\nexport * from './cdn.js'\nexport * from './components/FEAASBase.js'\nexport * from './components/FEAASElement.js'\nexport * from './components/FEAASComponent.js'\nexport * from './components/FEAASLoader.js'\nexport * from './components/FEAASStylesheet.js'\n\ndeclare global {\n  interface Window {\n    FEAASLoading: Promise<any>\n    FEAASElement: typeof FEAASElement\n  }\n}\n\nif (typeof window != 'undefined') {\n  window.FEAASElement = FEAASElement\n  window.FEAASLoading ??= Promise.resolve()\n}\n", "export type ControlledPromise<T> = Promise<T> & {\n  resolve: (...args: any) => void\n  reject: (e: Error) => void\n  restart: () => ControlledPromise<T>\n  first: ControlledPromise<T>\n}\n\nexport function ControlledPromise<T>(onSuccess?: (result: T) => void, onFailure = (e: Error) => {}) {\n  var first: ControlledPromise<T>\n  const restart = () => {\n    var resolve: (...args: any) => void\n    var reject: (e: Error) => void\n    const promise = new Promise<T>((success, failure) => {\n      resolve = (value: T) => {\n        onSuccess?.(value)\n        success(value)\n      }\n      reject = failure\n    })\n    var controlled: ControlledPromise<T> = Object.assign(promise, {\n      resolve,\n      reject,\n      restart,\n      first\n    })\n    first = controlled\n\n    // Avoid unhandled rejection\n    controlled.catch(onFailure)\n\n    return controlled\n  }\n  return restart()\n}\n", "import type { JSXElementConstructor, ReactElement, ReactNode } from 'react'\nimport type ReactDOMClient from 'react-dom/client'\nimport type ReactDOM from 'react-dom'\nimport type React from 'react'\nimport { ControlledPromise } from '../utils/promise.js'\n\nexport type OptionalExcept<T, K extends keyof T> = Pick<T, K> & Partial<Omit<T, K>>\n\n// Shim in case it's required in node.js environment\nvar WebComponent =\n  typeof HTMLElement == 'undefined'\n    ? // @ts-ignore\n      typeof windowJSDOM != 'undefined'\n      ? // @ts-ignore\n        (windowJSDOM.HTMLElement as typeof HTMLElement)\n      : (class {} as unknown as typeof HTMLElement)\n    : HTMLElement\n\nexport interface ReactPayload {\n  React: typeof React\n  ReactDOM: typeof ReactDOM\n  ReactDOMClient: typeof ReactDOMClient\n}\n/**\n * FEAASBase is a superclass for FEAAS components with optional react support.\n *\n * Initialization lifecycle:\n *\n * - `set(props)`\n * - `load() => payload`\n * - `onLoad?(payload)`\n * - `update()`\n * - `render(payload, props)`\n * - `whenRendered`\n * - - / If needs to reload, e.g. bypass cache /\n * - - `onLoad(newPayload) `\n * - - `whenRendered`\n * - `whenLoaded`\n */\nexport class FEAASBase<Props = any, Payload = any> extends WebComponent {\n  static observedAttributes: string[]\n\n  defaultProps = {} as Partial<Props>\n\n  /** Return attributes as parsed values */\n  getProps(context?: HTMLElement): any {\n    return {}\n  }\n\n  /** Properties parsed in current tick */\n  props: Props\n  overrides: Props\n\n  /** Timer until next tick */\n  nextRender: number\n\n  /** Is/was component in the dom? */\n  connected = false\n\n  refs: Record<string, FEAASBase> = {}\n  descendants: FEAASBase[] = []\n\n  /** Result of lazy loading */\n  payload: Payload\n  whenLoaded = ControlledPromise<Payload>((payload) => {\n    this.payload = payload\n  })\n\n  constructor() {\n    super()\n    this.addEventListener('feaasMount', this)\n    this.addEventListener('feaasUnmount', this)\n  }\n\n  /** Attaches shadow root if getShadowRootOptions any settings, or uses element itself */\n  getRoot(): FEAASBase | HTMLElement | ShadowRoot {\n    return this\n  }\n\n  /** Attribute changes trigger props parsing and schedules re-rendering */\n  attributeChangedCallback(name: string, oldValue: string, newValue: string) {\n    this.set()\n  }\n\n  /** Components parses its attributes when connected, and schedules rendeirng */\n  connectedCallback() {\n    this.mount()\n  }\n  disconnectedCallback() {\n    this.unmount()\n  }\n\n  /**\n   * Web components are initialized depth-first, making child elements render before its parents. This could here\n   * attempts to avoid this and inverts the initialization logic, so that children are initialized in the context of its\n   * already-initialized parents.\n   *\n   * FEAAS components dispatch `feaasMount` event that allows components to store references to each other. In addition\n   * it allows external scripts to listen for initialization of FEAAS components\n   */\n  mount() {\n    try {\n      const parent = this.getParent() as FEAASBase\n      // Allow parent component to initialize first\n      if (parent && !parent.connected) return\n      if (this.connected) return\n      this.connected = true\n      this.log('FEAAS: Mount', this.tagName, this)\n      this.dispatchEvent(new Event('feaasMount', { bubbles: true, composed: true }))\n      this.getElements().map((element: FEAASBase) => element.mount?.())\n      this.set()\n    } catch (e) {\n      this.onError(e)\n    }\n  }\n\n  log(...args: any) {\n    console.log(...args)\n  }\n\n  /** Nothing special happens on unmount, except setting a flag */\n  unmount() {\n    if (!this.connected) return\n    this.log('FEAAS: Unmount', this)\n    this.dispatchEvent(new Event('feaasUnmount', { bubbles: true, composed: true }))\n    this.connected = false\n  }\n\n  getParent(onlyFeaas = true) {\n    for (\n      var p: HTMLElement = this;\n      (p = p.parentElement || ((p.parentNode instanceof ShadowRoot ? p.parentNode.host : null) as HTMLElement));\n\n    ) {\n      if (!onlyFeaas || p.tagName.startsWith('FEAAS-')) return p\n    }\n  }\n\n  getElements(root: HTMLElement | ShadowRoot = this.getRoot(), onlyFeaas = true): HTMLElement[] {\n    return Array.from(root.querySelectorAll('*'))\n      .map(\n        (el) =>\n          [\n            !onlyFeaas || el.tagName.startsWith('FEAAS-') ? el : null,\n            el.shadowRoot ? this.getElements(el.shadowRoot, onlyFeaas) : null\n          ] as HTMLElement[]\n      )\n      .flat()\n      .filter(Boolean)\n  }\n\n  /** Catch-all event handler that dispatches events to callback */\n  handleEvent(event: Event) {\n    const target = event.composedPath()[0] as FEAASBase\n    switch (event.type) {\n      case 'feaasMount':\n        if (target != this) this.nestedCallback(target)\n        break\n      case 'feaasUnmount':\n        if (target != this) this.unnestedCallback(target)\n        break\n    }\n  }\n\n  /** Act on children element being removed */\n  unnestedCallback(target: FEAASBase) {\n    const index = this.descendants.indexOf(target)\n    if (index == -1) return\n    this.log('FEAAS: Unnest', this, target)\n    this.descendants.splice(index, -1)\n    this.refs[target.getComponentName()] = null\n    if (target.refs.parent == this) target.refs.parent = null\n    if (target.refs.top == this) {\n      target.refs.top = target.refs.parent\n    }\n  }\n\n  /** Act on children element being added */\n  nestedCallback(target: FEAASBase): boolean | void {\n    const index = this.descendants.indexOf(target)\n    if (index != -1) return\n    this.descendants.push(target)\n    this.log('FEAAS: Nest', this, target)\n    this.refs[target.getComponentName()] = target\n    target.refs.top = this\n    target.refs.parent ||= this\n    if (target.render) {\n      for (var p: FEAASBase = target.refs.parent; p; p = p.refs.parent) {\n        if (p.render) {\n          target.refs.parentReact ||= p\n          target.refs.topReact = p\n        }\n      }\n    }\n  }\n\n  getComponentName() {\n    return this.tagName.replace('FEAAS-', '').toLowerCase()\n  }\n\n  /**\n   * Check if lazy component is ready to be loaded. For example a component may stay unloaded unless certain attributes\n   * are set\n   */\n  isReadyToLoad() {\n    return this.payload === undefined && this.getAttribute('hidden') == null\n  }\n\n  /** Generic error handler */\n  onError(error: Error, where: string = 'uncaught', handled = false) {\n    const event = new CustomEvent('feaasError', { bubbles: true, composed: true, detail: error })\n    this.dispatchEvent(event)\n    this.whenLoaded.reject(error)\n    if (!event.defaultPrevented && !handled) {\n      this.whenRendered.reject(error)\n      try {\n        this.unmount()\n      } catch (e) {}\n      return true\n    }\n    return false\n  }\n\n  shouldUpdateOnLoad() {\n    return true\n  }\n\n  onLoad: (payload: Payload) => void\n\n  /** Load lazy component & render */\n  async advance() {\n    try {\n      if (this.payload === undefined) {\n        if (!this.isReadyToLoad()) return\n        this.payload = null\n        this.dispatchEvent(new Event('feaasLoad', { bubbles: true, composed: true }))\n        const loaded = await this.load().catch((e) => {\n          this.payload = undefined\n          throw e\n        })\n\n        this.whenLoaded.resolve(loaded)\n\n        // Allow component to handle the post-loading\n        if (this.onLoad) {\n          return\n        }\n      } else if (this.payload == null) {\n        return\n      }\n      this.flush()\n      this.whenRendered.resolve(this)\n    } catch (e) {\n      this.onError(e)\n    }\n  }\n\n  flush() {\n    const flushSync = (this.payload as ReactPayload)?.ReactDOM?.flushSync\n    if (flushSync) {\n      flushSync(() => this.update())\n    } else {\n      this.update()\n    }\n  }\n\n  /** Invoke preloading logic that needs to finish before component can render */\n  load() {\n    return Promise.resolve(null)\n  }\n\n  /**\n   * Component-specific logic that updates the DOM. Default render implementation assume react rendering, in that case\n   * the component needs to provide React & ReactDOM references in its payload. Web component redefine its render to not\n   * use react at all\n   */\n  update(): any {\n    //this.log('FEAAS: React', this.tagName, this.payload)\n    if (this.payload == null) return\n    if (!this.render) return\n    const { React, ReactDOM, ReactDOMClient } = (this.payload as ReactPayload) || {}\n    if (!React) throw new Error(`${this.tagName}: React is not present in payload`)\n    if (!ReactDOM) throw new Error(`${this.tagName}: ReactDOM is not present in payload`)\n    if (!this.refs.topReact && !this.forceUpdateReact) {\n      if (ReactDOMClient) {\n        this.reactRoot ||= ReactDOMClient.createRoot(this.getReactRootElement())\n        this.reactRoot.render(this.getReactElement())\n      } else {\n        ReactDOM.render(this.getReactElement(), this.getReactRootElement())\n      }\n    } else if (this.forceUpdateReact) {\n      this.forceUpdateReact?.()\n    } else {\n      this.refs.topReact.forceUpdateReact?.()\n    }\n  }\n\n  invokeReactRendering(): ReactNode {\n    const { React, ReactDOM } = (this.payload as ReactPayload) || {}\n    if (!this.connected) return null\n    const children = this.descendants\n      .filter((r) => {\n        return r.refs.parentReact == this && r.payload\n      })\n      .map((child: FEAASBase<any, any>, index) => {\n        return this.getReactElement(child)\n      })\n    return this.render({ ...this.props, children }, this.payload)\n  }\n\n  reactWrapper: React.FunctionComponent\n  reactErrorBoundary: new (...args: any) => React.Component<{ children: any; slot: string }, { error: Error }>\n  reactRoot: ReactDOMClient.Root\n\n  getReactErrorBoundary(target: FEAASBase = this, displayName = target.tagName) {\n    if (this.reactErrorBoundary) return this.reactErrorBoundary\n\n    const { React, ReactDOM } = (target.payload as ReactPayload) || {}\n    return (this.reactErrorBoundary ||= class FEAASErrorBoundary extends React.Component<\n      { children: any; slot: string },\n      { error: Error }\n    > {\n      state = {\n        error: null as Error\n      }\n\n      static getDerivedStateFromError(error: Error) {\n        return { error: error }\n      }\n\n      componentDidCatch(error: Error, errorInfo: any) {\n        console.error(`FEAAS: ${target.tagName} Error:`, error, errorInfo)\n        target.onError(error, 'react')\n        //this.setState({ error: error })\n      }\n\n      render() {\n        if (this.state.error) {\n          // target.classList.add('feaas-error')\n          return\n          //return <h1>There seems to be a problem.</h1>\n        }\n        //if (target.classList.contains('feaas-error')) target.classList.remove('feaas-error')\n\n        return this.props.children\n      }\n    })\n  }\n\n  getReactElement(target: FEAASBase = this, props?: any) {\n    const { React, ReactDOM } = (target.payload as ReactPayload) || {}\n    const ErrorBoundary = this.getReactErrorBoundary()\n    const Wrapper = this.getReactWrapper(target)\n    return (\n      <ErrorBoundary key={target.tagName + '-' + target.getUID()} slot={target.getAttribute('slot')}>\n        <Wrapper />\n      </ErrorBoundary>\n    )\n  }\n\n  getReactWrapper(target: FEAASBase = this, displayName = target.tagName) {\n    if (target.reactWrapper) return target.reactWrapper\n\n    const { React, ReactDOM } = (target.payload as ReactPayload) || {}\n\n    target.reactWrapper = (props?: any) => {\n      if (target.render) {\n        const [value, forceUpdateReact] = React.useReducer((r) => r + 1, 0)\n        target.forceUpdateReact = forceUpdateReact\n        return ReactDOM.createPortal(<>{target.invokeReactRendering()}</>, target.getReactRootElement())\n      } else {\n        return target.update()\n      }\n    }\n\n    Object.assign(target.reactWrapper, {\n      key: target.tagName + '-' + target.getUID(),\n      displayName: displayName\n    })\n\n    return target.reactWrapper\n  }\n\n  uid: string\n  getUID() {\n    return (this.uid ||= String(Math.random()))\n  }\n  forceUpdateReact: (node?: ReactNode) => void\n\n  /**\n   * Render method that is pretty much the same as React Functional component, but with extra second argument for\n   * payload (usually result of import, it is expected to have React in scope).\n   */\n  render?(props: React.PropsWithChildren<Props>, payload: Payload): ReactNode | ReactElement\n\n  useShadowRoot: boolean\n  getShadowRoot() {\n    if (!this.shadowRoot) {\n      this.attachShadow({ mode: 'open' })\n    }\n    return this.shadowRoot\n  }\n  getReactRootElement(): HTMLElement | ShadowRoot {\n    return this.useShadowRoot ? this.getShadowRoot() : this.getRoot()\n  }\n\n  /** Set props and return values on new next tick */\n  set(overrides?: Partial<Props>) {\n    try {\n      this.scheduleRender()\n      this.overrides = {\n        ...this.overrides,\n        ...overrides\n      }\n      this.props = {\n        ...this.getProps(),\n        ...this.overrides\n      }\n      for (var property in this.props) {\n        const value = this.props[property]\n        const attribute = property.replace(/([a-z])([A-Z])/g, '$1-$2').toLowerCase()\n        if (value == null || value === this.defaultProps[property as keyof typeof this.defaultProps]) {\n          this.removeAttribute(attribute)\n        } else if (typeof value == 'string' || typeof value == 'number' || typeof value == 'boolean') {\n          if (this.getAttribute(attribute) != String(value)) this.setAttribute(attribute, String(value))\n        }\n      }\n    } catch (e) {\n      this.whenRendered.reject(e)\n      this.onError(e, 'set')\n    }\n    return this\n  }\n\n  import(path: string): Promise<Payload> {\n    return import(/* @vite-ignore */ /* webpackIgnore: true */ path)\n  }\n\n  /** Schedule rendering on next tick, to batch multiple attribute changes */\n  initialized: boolean\n  whenRendered = ControlledPromise<this>(\n    () => (this.initialized = true),\n    () => cancelAnimationFrame(this.nextRender)\n  )\n  scheduleRender() {\n    if (this.nextRender == null) {\n      this.whenRendered = this.whenRendered.restart()\n    }\n    cancelAnimationFrame(this.nextRender)\n    this.nextRender = requestAnimationFrame(() => {\n      this.nextRender = null\n      this.advance().catch((e) => {})\n    })\n  }\n\n  formatURL(src: string, hostname: string) {\n    if (typeof src == 'string' && src.match(/^\\/[^\\/]/)) {\n      return hostname + src\n    } else {\n      return src\n    }\n  }\n\n  getContextAttribute(name: string, element = this) {\n    for (\n      var p: HTMLElement = this;\n      (p = p.parentElement || ((p.parentNode instanceof ShadowRoot ? p.parentNode.host : null) as HTMLElement));\n\n    ) {\n      if (p.getAttribute(name) != null) return p.getAttribute(name)\n    }\n    return this.getAttribute(name)\n  }\n\n  static register(tagName: string, win?: Window) {\n    if (win == null) win = typeof window != 'undefined' ? window : null\n    if (win && !win.customElements.get(tagName)) {\n      win.customElements.define(tagName, this)\n    }\n  }\n}\n\nexport { FEAASBase as Base }\n", "import type { ReactNode, ReactElement, JSXElementConstructor, PropsWithChildren } from 'react'\nimport { FEAASBase } from './FEAASBase.js'\n\nexport type ReactModules = {\n  React: typeof React\n  ReactDOM: typeof ReactDOM\n}\nexport type ReactJSX = ReactNode | ReactElement<any, string | JSXElementConstructor<any>>\nexport type FEAASReactRender<P> = {\n  (this: FEAASElement<P>, props: P, payload: ReactModules): ReactJSX\n}\n\nexport default class FEAASElement<P> extends FEAASBase<P, ReactModules> {\n  load() {\n    return Promise.all([\n      // @ts-ignore @webpack-ignore\n      import('https://cdn.skypack.dev/react'),\n      // @ts-ignore\n      import('https://cdn.skypack.dev/react-dom')\n    ]).then(([React, ReactDOM]) => {\n      return { React, ReactDOM }\n    })\n  }\n\n  render({}: P, { React }: ReactModules): ReactJSX {\n    return <></>\n  }\n}\n\ninterface MyComponentProps {\n  counter: string\n}\n\nexport class MyComponent extends FEAASElement<MyComponentProps> {\n  // will re-render component if any of these attributes have changed\n  static observedAttributes = ['counter']\n\n  useShadowRoot = true\n\n  // parse attributes from web component to react-ready form\n  getProps() {\n    return {\n      counter: parseFloat(this.getAttribute('counter'))\n    }\n  }\n\n  // First argument is props, second arguments is React stuff\n  // Destructuring React is important for JSX to work\n  render({ counter }: MyComponentProps, { React }: ReactModules): ReactJSX {\n    const [updates, setUpdates] = React.useState(0)\n    React.useEffect(() => {\n      setUpdates((u) => u + 1)\n    }, [counter])\n    return (\n      <>\n        <p>Rendering attribute: {counter}</p>\n        <p>Triggered updates: {updates}</p>\n      </>\n    )\n  }\n}\n", "function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, _typeof(obj);\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  Object.defineProperty(Constructor, \"prototype\", {\n    writable: false\n  });\n  return Constructor;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function\");\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      writable: true,\n      configurable: true\n    }\n  });\n  Object.defineProperty(subClass, \"prototype\", {\n    writable: false\n  });\n  if (superClass) _setPrototypeOf(subClass, superClass);\n}\n\nfunction _getPrototypeOf(o) {\n  _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf.bind() : function _getPrototypeOf(o) {\n    return o.__proto__ || Object.getPrototypeOf(o);\n  };\n  return _getPrototypeOf(o);\n}\n\nfunction _setPrototypeOf(o, p) {\n  _setPrototypeOf = Object.setPrototypeOf ? Object.setPrototypeOf.bind() : function _setPrototypeOf(o, p) {\n    o.__proto__ = p;\n    return o;\n  };\n  return _setPrototypeOf(o, p);\n}\n\nfunction _isNativeReflectConstruct() {\n  if (typeof Reflect === \"undefined\" || !Reflect.construct) return false;\n  if (Reflect.construct.sham) return false;\n  if (typeof Proxy === \"function\") return true;\n\n  try {\n    Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {}));\n    return true;\n  } catch (e) {\n    return false;\n  }\n}\n\nfunction _construct(Parent, args, Class) {\n  if (_isNativeReflectConstruct()) {\n    _construct = Reflect.construct.bind();\n  } else {\n    _construct = function _construct(Parent, args, Class) {\n      var a = [null];\n      a.push.apply(a, args);\n      var Constructor = Function.bind.apply(Parent, a);\n      var instance = new Constructor();\n      if (Class) _setPrototypeOf(instance, Class.prototype);\n      return instance;\n    };\n  }\n\n  return _construct.apply(null, arguments);\n}\n\nfunction _isNativeFunction(fn) {\n  return Function.toString.call(fn).indexOf(\"[native code]\") !== -1;\n}\n\nfunction _wrapNativeSuper(Class) {\n  var _cache = typeof Map === \"function\" ? new Map() : undefined;\n\n  _wrapNativeSuper = function _wrapNativeSuper(Class) {\n    if (Class === null || !_isNativeFunction(Class)) return Class;\n\n    if (typeof Class !== \"function\") {\n      throw new TypeError(\"Super expression must either be null or a function\");\n    }\n\n    if (typeof _cache !== \"undefined\") {\n      if (_cache.has(Class)) return _cache.get(Class);\n\n      _cache.set(Class, Wrapper);\n    }\n\n    function Wrapper() {\n      return _construct(Class, arguments, _getPrototypeOf(this).constructor);\n    }\n\n    Wrapper.prototype = Object.create(Class.prototype, {\n      constructor: {\n        value: Wrapper,\n        enumerable: false,\n        writable: true,\n        configurable: true\n      }\n    });\n    return _setPrototypeOf(Wrapper, Class);\n  };\n\n  return _wrapNativeSuper(Class);\n}\n\nfunction _assertThisInitialized(self) {\n  if (self === void 0) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return self;\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (call && (typeof call === \"object\" || typeof call === \"function\")) {\n    return call;\n  } else if (call !== void 0) {\n    throw new TypeError(\"Derived constructors may only return object or undefined\");\n  }\n\n  return _assertThisInitialized(self);\n}\n\nfunction _createSuper(Derived) {\n  var hasNativeReflectConstruct = _isNativeReflectConstruct();\n\n  return function _createSuperInternal() {\n    var Super = _getPrototypeOf(Derived),\n        result;\n\n    if (hasNativeReflectConstruct) {\n      var NewTarget = _getPrototypeOf(this).constructor;\n\n      result = Reflect.construct(Super, arguments, NewTarget);\n    } else {\n      result = Super.apply(this, arguments);\n    }\n\n    return _possibleConstructorReturn(this, result);\n  };\n}\n\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\n\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\n\nfunction _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n\n  return arr2;\n}\n\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nfunction _createForOfIteratorHelper(o, allowArrayLike) {\n  var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"];\n\n  if (!it) {\n    if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") {\n      if (it) o = it;\n      var i = 0;\n\n      var F = function () {};\n\n      return {\n        s: F,\n        n: function () {\n          if (i >= o.length) return {\n            done: true\n          };\n          return {\n            done: false,\n            value: o[i++]\n          };\n        },\n        e: function (e) {\n          throw e;\n        },\n        f: F\n      };\n    }\n\n    throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n  }\n\n  var normalCompletion = true,\n      didErr = false,\n      err;\n  return {\n    s: function () {\n      it = it.call(o);\n    },\n    n: function () {\n      var step = it.next();\n      normalCompletion = step.done;\n      return step;\n    },\n    e: function (e) {\n      didErr = true;\n      err = e;\n    },\n    f: function () {\n      try {\n        if (!normalCompletion && it.return != null) it.return();\n      } finally {\n        if (didErr) throw err;\n      }\n    }\n  };\n}\n\nvar hasOwnProp = Object.prototype.hasOwnProperty;\n/**\n * @typedef {null|boolean|number|string|PlainObject|GenericArray} JSONObject\n */\n\n/**\n * @typedef {any} AnyItem\n */\n\n/**\n * @typedef {any} AnyResult\n */\n\n/**\n * Copies array and then pushes item into it.\n * @param {GenericArray} arr Array to copy and into which to push\n * @param {AnyItem} item Array item to add (to end)\n * @returns {GenericArray} Copy of the original array\n */\n\nfunction push(arr, item) {\n  arr = arr.slice();\n  arr.push(item);\n  return arr;\n}\n/**\n * Copies array and then unshifts item into it.\n * @param {AnyItem} item Array item to add (to beginning)\n * @param {GenericArray} arr Array to copy and into which to unshift\n * @returns {GenericArray} Copy of the original array\n */\n\n\nfunction unshift(item, arr) {\n  arr = arr.slice();\n  arr.unshift(item);\n  return arr;\n}\n/**\n * Caught when JSONPath is used without `new` but rethrown if with `new`\n * @extends Error\n */\n\n\nvar NewError = /*#__PURE__*/function (_Error) {\n  _inherits(NewError, _Error);\n\n  var _super = _createSuper(NewError);\n\n  /**\n   * @param {AnyResult} value The evaluated scalar value\n   */\n  function NewError(value) {\n    var _this;\n\n    _classCallCheck(this, NewError);\n\n    _this = _super.call(this, 'JSONPath should not be called with \"new\" (it prevents return ' + 'of (unwrapped) scalar values)');\n    _this.avoidNew = true;\n    _this.value = value;\n    _this.name = 'NewError';\n    return _this;\n  }\n\n  return _createClass(NewError);\n}( /*#__PURE__*/_wrapNativeSuper(Error));\n/**\n* @typedef {PlainObject} ReturnObject\n* @property {string} path\n* @property {JSONObject} value\n* @property {PlainObject|GenericArray} parent\n* @property {string} parentProperty\n*/\n\n/**\n* @callback JSONPathCallback\n* @param {string|PlainObject} preferredOutput\n* @param {\"value\"|\"property\"} type\n* @param {ReturnObject} fullRetObj\n* @returns {void}\n*/\n\n/**\n* @callback OtherTypeCallback\n* @param {JSONObject} val\n* @param {string} path\n* @param {PlainObject|GenericArray} parent\n* @param {string} parentPropName\n* @returns {boolean}\n*/\n\n/* eslint-disable max-len -- Can make multiline type after https://github.com/syavorsky/comment-parser/issues/109 */\n\n/**\n * @typedef {PlainObject} JSONPathOptions\n * @property {JSON} json\n * @property {string|string[]} path\n * @property {\"value\"|\"path\"|\"pointer\"|\"parent\"|\"parentProperty\"|\"all\"} [resultType=\"value\"]\n * @property {boolean} [flatten=false]\n * @property {boolean} [wrap=true]\n * @property {PlainObject} [sandbox={}]\n * @property {boolean} [preventEval=false]\n * @property {PlainObject|GenericArray|null} [parent=null]\n * @property {string|null} [parentProperty=null]\n * @property {JSONPathCallback} [callback]\n * @property {OtherTypeCallback} [otherTypeCallback] Defaults to\n *   function which throws on encountering `@other`\n * @property {boolean} [autostart=true]\n */\n\n/* eslint-enable max-len -- Can make multiline type after https://github.com/syavorsky/comment-parser/issues/109 */\n\n/**\n * @param {string|JSONPathOptions} opts If a string, will be treated as `expr`\n * @param {string} [expr] JSON path to evaluate\n * @param {JSON} [obj] JSON object to evaluate against\n * @param {JSONPathCallback} [callback] Passed 3 arguments: 1) desired payload\n *     per `resultType`, 2) `\"value\"|\"property\"`, 3) Full returned object with\n *     all payloads\n * @param {OtherTypeCallback} [otherTypeCallback] If `@other()` is at the end\n *   of one's query, this will be invoked with the value of the item, its\n *   path, its parent, and its parent's property name, and it should return\n *   a boolean indicating whether the supplied value belongs to the \"other\"\n *   type or not (or it may handle transformations and return `false`).\n * @returns {JSONPath}\n * @class\n */\n\n\nfunction JSONPath(opts, expr, obj, callback, otherTypeCallback) {\n  // eslint-disable-next-line no-restricted-syntax\n  if (!(this instanceof JSONPath)) {\n    try {\n      return new JSONPath(opts, expr, obj, callback, otherTypeCallback);\n    } catch (e) {\n      if (!e.avoidNew) {\n        throw e;\n      }\n\n      return e.value;\n    }\n  }\n\n  if (typeof opts === 'string') {\n    otherTypeCallback = callback;\n    callback = obj;\n    obj = expr;\n    expr = opts;\n    opts = null;\n  }\n\n  var optObj = opts && _typeof(opts) === 'object';\n  opts = opts || {};\n  this.json = opts.json || obj;\n  this.path = opts.path || expr;\n  this.resultType = opts.resultType || 'value';\n  this.flatten = opts.flatten || false;\n  this.wrap = hasOwnProp.call(opts, 'wrap') ? opts.wrap : true;\n  this.sandbox = opts.sandbox || {};\n  this.preventEval = opts.preventEval || false;\n  this.parent = opts.parent || null;\n  this.parentProperty = opts.parentProperty || null;\n  this.callback = opts.callback || callback || null;\n\n  this.otherTypeCallback = opts.otherTypeCallback || otherTypeCallback || function () {\n    throw new TypeError('You must supply an otherTypeCallback callback option ' + 'with the @other() operator.');\n  };\n\n  if (opts.autostart !== false) {\n    var args = {\n      path: optObj ? opts.path : expr\n    };\n\n    if (!optObj) {\n      args.json = obj;\n    } else if ('json' in opts) {\n      args.json = opts.json;\n    }\n\n    var ret = this.evaluate(args);\n\n    if (!ret || _typeof(ret) !== 'object') {\n      throw new NewError(ret);\n    }\n\n    return ret;\n  }\n} // PUBLIC METHODS\n\n\nJSONPath.prototype.evaluate = function (expr, json, callback, otherTypeCallback) {\n  var _this2 = this;\n\n  var currParent = this.parent,\n      currParentProperty = this.parentProperty;\n  var flatten = this.flatten,\n      wrap = this.wrap;\n  this.currResultType = this.resultType;\n  this.currPreventEval = this.preventEval;\n  this.currSandbox = this.sandbox;\n  callback = callback || this.callback;\n  this.currOtherTypeCallback = otherTypeCallback || this.otherTypeCallback;\n  json = json || this.json;\n  expr = expr || this.path;\n\n  if (expr && _typeof(expr) === 'object' && !Array.isArray(expr)) {\n    if (!expr.path && expr.path !== '') {\n      throw new TypeError('You must supply a \"path\" property when providing an object ' + 'argument to JSONPath.evaluate().');\n    }\n\n    if (!hasOwnProp.call(expr, 'json')) {\n      throw new TypeError('You must supply a \"json\" property when providing an object ' + 'argument to JSONPath.evaluate().');\n    }\n\n    var _expr = expr;\n    json = _expr.json;\n    flatten = hasOwnProp.call(expr, 'flatten') ? expr.flatten : flatten;\n    this.currResultType = hasOwnProp.call(expr, 'resultType') ? expr.resultType : this.currResultType;\n    this.currSandbox = hasOwnProp.call(expr, 'sandbox') ? expr.sandbox : this.currSandbox;\n    wrap = hasOwnProp.call(expr, 'wrap') ? expr.wrap : wrap;\n    this.currPreventEval = hasOwnProp.call(expr, 'preventEval') ? expr.preventEval : this.currPreventEval;\n    callback = hasOwnProp.call(expr, 'callback') ? expr.callback : callback;\n    this.currOtherTypeCallback = hasOwnProp.call(expr, 'otherTypeCallback') ? expr.otherTypeCallback : this.currOtherTypeCallback;\n    currParent = hasOwnProp.call(expr, 'parent') ? expr.parent : currParent;\n    currParentProperty = hasOwnProp.call(expr, 'parentProperty') ? expr.parentProperty : currParentProperty;\n    expr = expr.path;\n  }\n\n  currParent = currParent || null;\n  currParentProperty = currParentProperty || null;\n\n  if (Array.isArray(expr)) {\n    expr = JSONPath.toPathString(expr);\n  }\n\n  if (!expr && expr !== '' || !json) {\n    return undefined;\n  }\n\n  var exprList = JSONPath.toPathArray(expr);\n\n  if (exprList[0] === '$' && exprList.length > 1) {\n    exprList.shift();\n  }\n\n  this._hasParentSelector = null;\n\n  var result = this._trace(exprList, json, ['$'], currParent, currParentProperty, callback).filter(function (ea) {\n    return ea && !ea.isParentSelector;\n  });\n\n  if (!result.length) {\n    return wrap ? [] : undefined;\n  }\n\n  if (!wrap && result.length === 1 && !result[0].hasArrExpr) {\n    return this._getPreferredOutput(result[0]);\n  }\n\n  return result.reduce(function (rslt, ea) {\n    var valOrPath = _this2._getPreferredOutput(ea);\n\n    if (flatten && Array.isArray(valOrPath)) {\n      rslt = rslt.concat(valOrPath);\n    } else {\n      rslt.push(valOrPath);\n    }\n\n    return rslt;\n  }, []);\n}; // PRIVATE METHODS\n\n\nJSONPath.prototype._getPreferredOutput = function (ea) {\n  var resultType = this.currResultType;\n\n  switch (resultType) {\n    case 'all':\n      {\n        var path = Array.isArray(ea.path) ? ea.path : JSONPath.toPathArray(ea.path);\n        ea.pointer = JSONPath.toPointer(path);\n        ea.path = typeof ea.path === 'string' ? ea.path : JSONPath.toPathString(ea.path);\n        return ea;\n      }\n\n    case 'value':\n    case 'parent':\n    case 'parentProperty':\n      return ea[resultType];\n\n    case 'path':\n      return JSONPath.toPathString(ea[resultType]);\n\n    case 'pointer':\n      return JSONPath.toPointer(ea.path);\n\n    default:\n      throw new TypeError('Unknown result type');\n  }\n};\n\nJSONPath.prototype._handleCallback = function (fullRetObj, callback, type) {\n  if (callback) {\n    var preferredOutput = this._getPreferredOutput(fullRetObj);\n\n    fullRetObj.path = typeof fullRetObj.path === 'string' ? fullRetObj.path : JSONPath.toPathString(fullRetObj.path); // eslint-disable-next-line n/callback-return\n\n    callback(preferredOutput, type, fullRetObj);\n  }\n};\n/**\n *\n * @param {string} expr\n * @param {JSONObject} val\n * @param {string} path\n * @param {PlainObject|GenericArray} parent\n * @param {string} parentPropName\n * @param {JSONPathCallback} callback\n * @param {boolean} hasArrExpr\n * @param {boolean} literalPriority\n * @returns {ReturnObject|ReturnObject[]}\n */\n\n\nJSONPath.prototype._trace = function (expr, val, path, parent, parentPropName, callback, hasArrExpr, literalPriority) {\n  var _this3 = this;\n\n  // No expr to follow? return path and value as the result of\n  //  this trace branch\n  var retObj;\n\n  if (!expr.length) {\n    retObj = {\n      path: path,\n      value: val,\n      parent: parent,\n      parentProperty: parentPropName,\n      hasArrExpr: hasArrExpr\n    };\n\n    this._handleCallback(retObj, callback, 'value');\n\n    return retObj;\n  }\n\n  var loc = expr[0],\n      x = expr.slice(1); // We need to gather the return value of recursive trace calls in order to\n  // do the parent sel computation.\n\n  var ret = [];\n  /**\n   *\n   * @param {ReturnObject|ReturnObject[]} elems\n   * @returns {void}\n   */\n\n  function addRet(elems) {\n    if (Array.isArray(elems)) {\n      // This was causing excessive stack size in Node (with or\n      //  without Babel) against our performance test:\n      //  `ret.push(...elems);`\n      elems.forEach(function (t) {\n        ret.push(t);\n      });\n    } else {\n      ret.push(elems);\n    }\n  }\n\n  if ((typeof loc !== 'string' || literalPriority) && val && hasOwnProp.call(val, loc)) {\n    // simple case--directly follow property\n    addRet(this._trace(x, val[loc], push(path, loc), val, loc, callback, hasArrExpr)); // eslint-disable-next-line unicorn/prefer-switch -- Part of larger `if`\n  } else if (loc === '*') {\n    // all child properties\n    this._walk(val, function (m) {\n      addRet(_this3._trace(x, val[m], push(path, m), val, m, callback, true, true));\n    });\n  } else if (loc === '..') {\n    // all descendent parent properties\n    // Check remaining expression with val's immediate children\n    addRet(this._trace(x, val, path, parent, parentPropName, callback, hasArrExpr));\n\n    this._walk(val, function (m) {\n      // We don't join m and x here because we only want parents,\n      //   not scalar values\n      if (_typeof(val[m]) === 'object') {\n        // Keep going with recursive descent on val's\n        //   object children\n        addRet(_this3._trace(expr.slice(), val[m], push(path, m), val, m, callback, true));\n      }\n    }); // The parent sel computation is handled in the frame above using the\n    // ancestor object of val\n\n  } else if (loc === '^') {\n    // This is not a final endpoint, so we do not invoke the callback here\n    this._hasParentSelector = true;\n    return {\n      path: path.slice(0, -1),\n      expr: x,\n      isParentSelector: true\n    };\n  } else if (loc === '~') {\n    // property name\n    retObj = {\n      path: push(path, loc),\n      value: parentPropName,\n      parent: parent,\n      parentProperty: null\n    };\n\n    this._handleCallback(retObj, callback, 'property');\n\n    return retObj;\n  } else if (loc === '$') {\n    // root only\n    addRet(this._trace(x, val, path, null, null, callback, hasArrExpr));\n  } else if (/^(\\x2D?[0-9]*):(\\x2D?[0-9]*):?([0-9]*)$/.test(loc)) {\n    // [start:end:step]  Python slice syntax\n    addRet(this._slice(loc, x, val, path, parent, parentPropName, callback));\n  } else if (loc.indexOf('?(') === 0) {\n    // [?(expr)] (filtering)\n    if (this.currPreventEval) {\n      throw new Error('Eval [?(expr)] prevented in JSONPath expression.');\n    }\n\n    var safeLoc = loc.replace(/^\\?\\(((?:[\\0-\\t\\x0B\\f\\x0E-\\u2027\\u202A-\\uD7FF\\uE000-\\uFFFF]|[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]|[\\uD800-\\uDBFF](?![\\uDC00-\\uDFFF])|(?:[^\\uD800-\\uDBFF]|^)[\\uDC00-\\uDFFF])*?)\\)$/, '$1');\n\n    this._walk(val, function (m) {\n      if (_this3._eval(safeLoc, val[m], m, path, parent, parentPropName)) {\n        addRet(_this3._trace(x, val[m], push(path, m), val, m, callback, true));\n      }\n    });\n  } else if (loc[0] === '(') {\n    // [(expr)] (dynamic property/index)\n    if (this.currPreventEval) {\n      throw new Error('Eval [(expr)] prevented in JSONPath expression.');\n    } // As this will resolve to a property name (but we don't know it\n    //  yet), property and parent information is relative to the\n    //  parent of the property to which this expression will resolve\n\n\n    addRet(this._trace(unshift(this._eval(loc, val, path[path.length - 1], path.slice(0, -1), parent, parentPropName), x), val, path, parent, parentPropName, callback, hasArrExpr));\n  } else if (loc[0] === '@') {\n    // value type: @boolean(), etc.\n    var addType = false;\n    var valueType = loc.slice(1, -2);\n\n    switch (valueType) {\n      case 'scalar':\n        if (!val || !['object', 'function'].includes(_typeof(val))) {\n          addType = true;\n        }\n\n        break;\n\n      case 'boolean':\n      case 'string':\n      case 'undefined':\n      case 'function':\n        // eslint-disable-next-line valid-typeof\n        if (_typeof(val) === valueType) {\n          addType = true;\n        }\n\n        break;\n\n      case 'integer':\n        if (Number.isFinite(val) && !(val % 1)) {\n          addType = true;\n        }\n\n        break;\n\n      case 'number':\n        if (Number.isFinite(val)) {\n          addType = true;\n        }\n\n        break;\n\n      case 'nonFinite':\n        if (typeof val === 'number' && !Number.isFinite(val)) {\n          addType = true;\n        }\n\n        break;\n\n      case 'object':\n        // eslint-disable-next-line valid-typeof\n        if (val && _typeof(val) === valueType) {\n          addType = true;\n        }\n\n        break;\n\n      case 'array':\n        if (Array.isArray(val)) {\n          addType = true;\n        }\n\n        break;\n\n      case 'other':\n        addType = this.currOtherTypeCallback(val, path, parent, parentPropName);\n        break;\n\n      case 'null':\n        if (val === null) {\n          addType = true;\n        }\n\n        break;\n\n      /* c8 ignore next 2 */\n\n      default:\n        throw new TypeError('Unknown value type ' + valueType);\n    }\n\n    if (addType) {\n      retObj = {\n        path: path,\n        value: val,\n        parent: parent,\n        parentProperty: parentPropName\n      };\n\n      this._handleCallback(retObj, callback, 'value');\n\n      return retObj;\n    } // `-escaped property\n\n  } else if (loc[0] === '`' && val && hasOwnProp.call(val, loc.slice(1))) {\n    var locProp = loc.slice(1);\n    addRet(this._trace(x, val[locProp], push(path, locProp), val, locProp, callback, hasArrExpr, true));\n  } else if (loc.includes(',')) {\n    // [name1,name2,...]\n    var parts = loc.split(',');\n\n    var _iterator = _createForOfIteratorHelper(parts),\n        _step;\n\n    try {\n      for (_iterator.s(); !(_step = _iterator.n()).done;) {\n        var part = _step.value;\n        addRet(this._trace(unshift(part, x), val, path, parent, parentPropName, callback, true));\n      } // simple case--directly follow property\n\n    } catch (err) {\n      _iterator.e(err);\n    } finally {\n      _iterator.f();\n    }\n  } else if (!literalPriority && val && hasOwnProp.call(val, loc)) {\n    addRet(this._trace(x, val[loc], push(path, loc), val, loc, callback, hasArrExpr, true));\n  } // We check the resulting values for parent selections. For parent\n  // selections we discard the value object and continue the trace with the\n  // current val object\n\n\n  if (this._hasParentSelector) {\n    for (var t = 0; t < ret.length; t++) {\n      var rett = ret[t];\n\n      if (rett && rett.isParentSelector) {\n        var tmp = this._trace(rett.expr, val, rett.path, parent, parentPropName, callback, hasArrExpr);\n\n        if (Array.isArray(tmp)) {\n          ret[t] = tmp[0];\n          var tl = tmp.length;\n\n          for (var tt = 1; tt < tl; tt++) {\n            t++;\n            ret.splice(t, 0, tmp[tt]);\n          }\n        } else {\n          ret[t] = tmp;\n        }\n      }\n    }\n  }\n\n  return ret;\n};\n\nJSONPath.prototype._walk = function (val, f) {\n  if (Array.isArray(val)) {\n    var n = val.length;\n\n    for (var i = 0; i < n; i++) {\n      f(i);\n    }\n  } else if (val && _typeof(val) === 'object') {\n    Object.keys(val).forEach(function (m) {\n      f(m);\n    });\n  }\n};\n\nJSONPath.prototype._slice = function (loc, expr, val, path, parent, parentPropName, callback) {\n  if (!Array.isArray(val)) {\n    return undefined;\n  }\n\n  var len = val.length,\n      parts = loc.split(':'),\n      step = parts[2] && Number.parseInt(parts[2]) || 1;\n  var start = parts[0] && Number.parseInt(parts[0]) || 0,\n      end = parts[1] && Number.parseInt(parts[1]) || len;\n  start = start < 0 ? Math.max(0, start + len) : Math.min(len, start);\n  end = end < 0 ? Math.max(0, end + len) : Math.min(len, end);\n  var ret = [];\n\n  for (var i = start; i < end; i += step) {\n    var tmp = this._trace(unshift(i, expr), val, path, parent, parentPropName, callback, true); // Should only be possible to be an array here since first part of\n    //   ``unshift(i, expr)` passed in above would not be empty, nor `~`,\n    //     nor begin with `@` (as could return objects)\n    // This was causing excessive stack size in Node (with or\n    //  without Babel) against our performance test: `ret.push(...tmp);`\n\n\n    tmp.forEach(function (t) {\n      ret.push(t);\n    });\n  }\n\n  return ret;\n};\n\nJSONPath.prototype._eval = function (code, _v, _vname, path, parent, parentPropName) {\n  this.currSandbox._$_parentProperty = parentPropName;\n  this.currSandbox._$_parent = parent;\n  this.currSandbox._$_property = _vname;\n  this.currSandbox._$_root = this.json;\n  this.currSandbox._$_v = _v;\n  var containsPath = code.includes('@path');\n\n  if (containsPath) {\n    this.currSandbox._$_path = JSONPath.toPathString(path.concat([_vname]));\n  }\n\n  var scriptCacheKey = 'script:' + code;\n\n  if (!JSONPath.cache[scriptCacheKey]) {\n    var script = code.replace(/@parentProperty/g, '_$_parentProperty').replace(/@parent/g, '_$_parent').replace(/@property/g, '_$_property').replace(/@root/g, '_$_root').replace(/@([\\t-\\r \\)\\.\\[\\xA0\\u1680\\u2000-\\u200A\\u2028\\u2029\\u202F\\u205F\\u3000\\uFEFF])/g, '_$_v$1');\n\n    if (containsPath) {\n      script = script.replace(/@path/g, '_$_path');\n    }\n\n    JSONPath.cache[scriptCacheKey] = new this.vm.Script(script);\n  }\n\n  try {\n    return JSONPath.cache[scriptCacheKey].runInNewContext(this.currSandbox);\n  } catch (e) {\n    throw new Error('jsonPath: ' + e.message + ': ' + code);\n  }\n}; // PUBLIC CLASS PROPERTIES AND METHODS\n// Could store the cache object itself\n\n\nJSONPath.cache = {};\n/**\n * @param {string[]} pathArr Array to convert\n * @returns {string} The path string\n */\n\nJSONPath.toPathString = function (pathArr) {\n  var x = pathArr,\n      n = x.length;\n  var p = '$';\n\n  for (var i = 1; i < n; i++) {\n    if (!/^(~|\\^|@(?:[\\0-\\t\\x0B\\f\\x0E-\\u2027\\u202A-\\uD7FF\\uE000-\\uFFFF]|[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]|[\\uD800-\\uDBFF](?![\\uDC00-\\uDFFF])|(?:[^\\uD800-\\uDBFF]|^)[\\uDC00-\\uDFFF])*?\\(\\))$/.test(x[i])) {\n      p += /^[\\*0-9]+$/.test(x[i]) ? '[' + x[i] + ']' : \"['\" + x[i] + \"']\";\n    }\n  }\n\n  return p;\n};\n/**\n * @param {string} pointer JSON Path\n * @returns {string} JSON Pointer\n */\n\n\nJSONPath.toPointer = function (pointer) {\n  var x = pointer,\n      n = x.length;\n  var p = '';\n\n  for (var i = 1; i < n; i++) {\n    if (!/^(~|\\^|@(?:[\\0-\\t\\x0B\\f\\x0E-\\u2027\\u202A-\\uD7FF\\uE000-\\uFFFF]|[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]|[\\uD800-\\uDBFF](?![\\uDC00-\\uDFFF])|(?:[^\\uD800-\\uDBFF]|^)[\\uDC00-\\uDFFF])*?\\(\\))$/.test(x[i])) {\n      p += '/' + x[i].toString().replace(/~/g, '~0').replace(/\\//g, '~1');\n    }\n  }\n\n  return p;\n};\n/**\n * @param {string} expr Expression to convert\n * @returns {string[]}\n */\n\n\nJSONPath.toPathArray = function (expr) {\n  var cache = JSONPath.cache;\n\n  if (cache[expr]) {\n    return cache[expr].concat();\n  }\n\n  var subx = [];\n  var normalized = expr // Properties\n  .replace(/@(?:null|boolean|number|string|integer|undefined|nonFinite|scalar|array|object|function|other)\\(\\)/g, ';$&;') // Parenthetical evaluations (filtering and otherwise), directly\n  //   within brackets or single quotes\n  .replace(/['\\[](\\??\\((?:[\\0-\\t\\x0B\\f\\x0E-\\u2027\\u202A-\\uD7FF\\uE000-\\uFFFF]|[\\uD800-\\uDBFF][\\uDC00-\\uDFFF]|[\\uD800-\\uDBFF](?![\\uDC00-\\uDFFF])|(?:[^\\uD800-\\uDBFF]|^)[\\uDC00-\\uDFFF])*?\\))['\\]]/g, function ($0, $1) {\n    return '[#' + (subx.push($1) - 1) + ']';\n  }) // Escape periods and tildes within properties\n  .replace(/\\[[\"']((?:(?!['\\]])[\\s\\S])*)[\"']\\]/g, function ($0, prop) {\n    return \"['\" + prop.replace(/\\./g, '%@%').replace(/~/g, '%%@@%%') + \"']\";\n  }) // Properties operator\n  .replace(/~/g, ';~;') // Split by property boundaries\n  .replace(/[\"']?\\.[\"']?(?!(?:(?!\\[)[\\s\\S])*\\])|\\[[\"']?/g, ';') // Reinsert periods within properties\n  .replace(/%@%/g, '.') // Reinsert tildes within properties\n  .replace(/%%@@%%/g, '~') // Parent\n  .replace(/(?:;)?(\\^+)(?:;)?/g, function ($0, ups) {\n    return ';' + ups.split('').join(';') + ';';\n  }) // Descendents\n  .replace(/;;;|;;/g, ';..;') // Remove trailing\n  .replace(/;$|'?\\]|'$/g, '');\n  var exprList = normalized.split(';').map(function (exp) {\n    var match = exp.match(/#([0-9]+)/);\n    return !match || !match[1] ? exp : subx[match[1]];\n  });\n  cache[expr] = exprList;\n  return cache[expr].concat();\n};\n\n/**\n * @typedef {any} ContextItem\n */\n\n/**\n * @typedef {any} EvaluatedResult\n */\n\n/**\n * @callback ConditionCallback\n * @param {ContextItem} item\n * @returns {boolean}\n */\n\n/**\n * Copy items out of one array into another.\n * @param {GenericArray} source Array with items to copy\n * @param {GenericArray} target Array to which to copy\n * @param {ConditionCallback} conditionCb Callback passed the current item;\n *     will move item if evaluates to `true`\n * @returns {void}\n */\n\nvar moveToAnotherArray = function moveToAnotherArray(source, target, conditionCb) {\n  var il = source.length;\n\n  for (var i = 0; i < il; i++) {\n    var item = source[i];\n\n    if (conditionCb(item)) {\n      target.push(source.splice(i--, 1)[0]);\n    }\n  }\n};\n/**\n * In-browser replacement for NodeJS' VM.Script.\n */\n\n\nvar Script = /*#__PURE__*/function () {\n  /**\n   * @param {string} expr Expression to evaluate\n   */\n  function Script(expr) {\n    _classCallCheck(this, Script);\n\n    this.code = expr;\n  }\n  /**\n   * @param {PlainObject} context Object whose items will be added\n   *   to evaluation\n   * @returns {EvaluatedResult} Result of evaluated code\n   */\n\n\n  _createClass(Script, [{\n    key: \"runInNewContext\",\n    value: function runInNewContext(context) {\n      var expr = this.code;\n      var keys = Object.keys(context);\n      var funcs = [];\n      moveToAnotherArray(keys, funcs, function (key) {\n        return typeof context[key] === 'function';\n      });\n      var values = keys.map(function (vr, i) {\n        return context[vr];\n      });\n      var funcString = funcs.reduce(function (s, func) {\n        var fString = context[func].toString();\n\n        if (!/function/.test(fString)) {\n          fString = 'function ' + fString;\n        }\n\n        return 'var ' + func + '=' + fString + ';' + s;\n      }, '');\n      expr = funcString + expr; // Mitigate http://perfectionkills.com/global-eval-what-are-the-options/#new_function\n\n      if (!/([\"'])use strict\\1/.test(expr) && !keys.includes('arguments')) {\n        expr = 'var arguments = undefined;' + expr;\n      } // Remove last semi so `return` will be inserted before\n      //  the previous one instead, allowing for the return\n      //  of a bare ending expression\n\n\n      expr = expr.replace(/;[\\t-\\r \\xA0\\u1680\\u2000-\\u200A\\u2028\\u2029\\u202F\\u205F\\u3000\\uFEFF]*$/, ''); // Insert `return`\n\n      var lastStatementEnd = expr.lastIndexOf(';');\n      var code = lastStatementEnd > -1 ? expr.slice(0, lastStatementEnd + 1) + ' return ' + expr.slice(lastStatementEnd + 1) : ' return ' + expr; // eslint-disable-next-line no-new-func\n\n      return _construct(Function, keys.concat([code])).apply(void 0, _toConsumableArray(values));\n    }\n  }]);\n\n  return Script;\n}();\n\nJSONPath.prototype.vm = {\n  Script: Script\n};\n\nexport { JSONPath };\n", "import { JSONPath } from 'jsonpath-plus'\n\nexport type Datascopes = Record<string, any> | any[]\n\nexport function cleanCollectionBit(path: string) {\n  return path.replace(/(\\[[^\\]\\[]+\\]|\\.\\*)$/g, '')\n}\n\nexport function normalizeCollectionScope(path: string) {\n  return cleanCollectionBit(path) + '.*'\n}\n\nexport function queryScopes(scopes: any, datapath: string, singleValue = false, json: any = scopes) {\n  var path = datapath\n  /* find closest parent scope */\n  const keys = Object.keys(scopes).sort((b, a) => a.length - b.length)\n  for (const scope of keys) {\n    if (datapath.startsWith(scope) && 'ends with it') {\n      if (scope == datapath) {\n        if (singleValue) {\n          return scopes[scope]\n        } else {\n          continue\n        }\n      }\n      path = datapath.substring(scope.length + 1)\n      json = scopes[scope]\n      break\n    }\n  }\n\n  var collection = JSONPath({ path, json })\n\n  // If regular path didn't match any data, try fallbacks\n  // datasourceId.wrapper.$.path\n  if (Array.isArray(collection) && collection?.length == 0) {\n    collection = [\n      // look up in `_` datasource id (catch-all id is used in JSS)\n      //   _.wrapper.$.path\n      path.replace(/^.*?\\./, '_.'),\n      // look up directly on data root\n      //   wrapper.$.path\n      path.replace(/^.*?\\./, ''),\n      // look up trimmed path in datasource\n      //   datasourceId.path\n      path.replace(/^([^.]+).*?\\.\\$\\./, '$1.'),\n      // look up trimmed path in catch all datasource\n      //   _.path\n      path.replace(/^.*?\\.\\$\\./, '_.'),\n      // look up trimmed path on root\n      // path\n      path.replace(/^.*?\\.\\$\\./, ''),\n      // for case of top-level object data mapping full path can be replaced to _\n      path.replace(/^[^.]+$/, '_')\n    ]\n      .filter((v, i, a) => a.indexOf(v) === i)\n      .reduce((v, path) => {\n        return v.length > 0 ? v : JSONPath({ path, json })\n      }, [] as any[])\n  }\n\n  if (singleValue && Array.isArray(collection)) {\n    return collection[0]\n  } else {\n    return collection\n  }\n}\n\nexport type CH1Node =\n  | {\n      type: string\n      text?: string\n      content?: CH1Node[]\n      marks?: CH1Node[]\n      attrs?: Record<string, any>\n    }\n  | CH1Node[]\nfunction serializeCH1Tag(data: any, attrs: Record<string, string> = {}, tag: string): string {\n  if (!tag) return serializeCH1RichText(data)\n  return `<${tag}${Object.entries(attrs)\n    .map(([k, v]) => v != null && ` ${k}=\"${v}\"`)\n    .filter(Boolean)\n    .join('')}>${serializeCH1RichText(data)}</${tag}>`.replace(/^<([a-z0-9][^>]*)><\\/[^>]+>$/, '<$1 />')\n}\nexport function serializeCH1RichText(data: CH1Node | string | null | undefined): string {\n  if (Array.isArray(data)) return data.map(serializeCH1RichText).join('\\n').trim()\n  if (typeof data == 'string') return data\n  if (data == null) return ''\n  switch (data.type) {\n    case 'heading':\n      const { level, ...attrs } = data.attrs\n      return serializeCH1Tag(data.content, attrs, 'h' + level)\n    case 'text':\n      return ((data.marks || []) as any[]).reduce((text, mark) => {\n        return serializeCH1Tag(\n          text,\n          mark.attrs,\n          {\n            link: 'a',\n            bold: 'strong',\n            italic: 'em',\n            strike: 's',\n            underline: 'u'\n          }[mark.type as string]\n        )\n      }, data.text?.replace(/\\s+/, ' '))\n    default:\n      return serializeCH1Tag(\n        data.content || data.text,\n        data.attrs,\n        {\n          bulletList: 'ul',\n          orderedList: 'ol',\n          listItem: 'li',\n          horizontalRule: 'hr',\n          paragraph: 'p',\n          codeBlock: 'code',\n          blockquote: 'blockquote'\n        }[data.type]\n      )\n  }\n}\n\nexport { JSONPath }\n", "/** Lightweight DOM parser and serializer to use in server environments */\n\nimport { Datascopes } from './data.js'\nimport { FEAASCustomizations, renderDOMElement } from './rendering.js'\n\ntype HTMLAttribute = { name: string; value: string }\n\nclass HTMLNode {\n  nodeName: string\n  nodeType: number\n  textContent?: string\n  attributes: HTMLAttribute[]\n  childNodes: HTMLNode[]\n  parentNode?: HTMLNode\n\n  constructor(nodeName: string, nodeType: number = 1, textContent?: string) {\n    this.nodeName = nodeName\n    this.nodeType = nodeType\n    this.textContent = textContent\n    this.attributes = []\n    this.childNodes = []\n  }\n\n  setAttribute(name: string, value: string) {\n    const attr = this.attributes.find((attr) => attr.name === name)\n    if (attr) {\n      attr.value = value\n    } else {\n      this.attributes.push({ name, value })\n    }\n  }\n\n  getAttribute(name: string): string | undefined {\n    const attr = this.attributes.find((attr) => attr.name === name)\n    return attr ? attr.value : undefined\n  }\n\n  insertBefore(newNode: HTMLNode, referenceNode: HTMLNode | null) {\n    newNode.parentNode = this\n    if (referenceNode === null) {\n      this.childNodes.push(newNode)\n    } else {\n      const index = this.childNodes.indexOf(referenceNode)\n      if (index !== -1) {\n        this.childNodes.splice(index, 0, newNode)\n      }\n    }\n  }\n\n  removeAttribute(attrName: string) {\n    const index = this.attributes.findIndex((attr) => attr.name === attrName)\n    if (index !== -1) {\n      this.attributes.splice(index, 1)\n    }\n  }\n\n  appendChild(newNode: HTMLNode) {\n    newNode.parentNode = this\n    this.childNodes.push(newNode)\n  }\n\n  get tagName() {\n    return this.nodeName?.toUpperCase()\n  }\n  get innerHTML() {\n    return serializeHTML(this.childNodes)\n  }\n  set innerHTML(html: string) {\n    this.childNodes = parseHTML(String(html ?? ''))\n  }\n  get outerHTML() {\n    return serializeHTML([this])\n  }\n\n  closest(selector: string): HTMLNode | null {\n    let currentNode: HTMLNode | undefined = this\n\n    while (currentNode) {\n      if (selectorMatchesNode(selector, currentNode)) {\n        return currentNode\n      }\n\n      currentNode = currentNode.parentNode\n    }\n\n    return null\n  }\n\n  querySelectorAll(selector: string): HTMLNode[] {\n    const selectors = selector.split(/\\s*,\\s*/)\n    const results: HTMLNode[] = []\n\n    const checkNode = (node: HTMLNode) => {\n      for (const sel of selectors) {\n        if (selectorMatchesNode(sel, node)) {\n          results.push(node)\n          break\n        }\n      }\n\n      for (const child of node.childNodes) {\n        checkNode(child)\n      }\n    }\n\n    for (const child of this.childNodes) {\n      checkNode(child)\n    }\n\n    return results\n  }\n\n  querySelector(selector: string): HTMLNode {\n    return this.querySelectorAll(selector)[0]\n  }\n\n  private findSibling(step: -1 | 1, elementTypeOnly?: boolean): HTMLNode | null {\n    if (!this.parentNode) return null\n    const siblings = this.parentNode.childNodes\n    const index = siblings.indexOf(this)\n    if (index === -1) return null\n\n    for (let i = index + step; i >= 0 && i < siblings.length; i += step) {\n      const sibling = siblings[i]\n      if (!elementTypeOnly || sibling.nodeType === 1) {\n        return sibling\n      }\n    }\n\n    return null\n  }\n\n  removeChild(child: HTMLNode): HTMLNode {\n    const index = this.childNodes.indexOf(child)\n    if (index === -1) return\n    this.childNodes.splice(index, 1)\n    child.parentNode = undefined\n    return child\n  }\n\n  get previousSibling(): HTMLNode | null {\n    return this.findSibling(-1)\n  }\n\n  get nextSibling(): HTMLNode | null {\n    return this.findSibling(1)\n  }\n\n  get previousElementSibling(): HTMLNode | null {\n    return this.findSibling(-1, true)\n  }\n\n  get nextElementSibling(): HTMLNode | null {\n    return this.findSibling(1, true)\n  }\n  cloneNode(deep: boolean = false): HTMLNode {\n    const clonedNode = new HTMLNode(this.nodeName, this.nodeType)\n    clonedNode.attributes = JSON.parse(JSON.stringify(this.attributes))\n\n    if (this.textContent) {\n      clonedNode.textContent = this.textContent\n    }\n\n    if (deep) {\n      for (const childNode of this.childNodes) {\n        const clonedChild = childNode.cloneNode(true)\n        clonedNode.appendChild(clonedChild)\n      }\n    }\n\n    return clonedNode\n  }\n  get parentElement() {\n    return this.parentNode?.nodeType == 1 ? this.parentNode : null\n  }\n\n  ownerDocument = {\n    createElement(name: string): HTMLNode {\n      return new HTMLNode(name)\n    }\n  }\n}\n\nfunction selectorMatchesNode(selector: string, node: HTMLNode): boolean {\n  const simpleSelectors = selector.match(/([.#]?[\\w-]+|\\[([\\w-]+)(=\"([^\"]*)\")?\\])/g)\n  if (!simpleSelectors) {\n    return false\n  }\n\n  for (const simpleSelector of simpleSelectors) {\n    if (simpleSelector.startsWith('#')) {\n      if (node.getAttribute('id') !== simpleSelector.slice(1)) {\n        return false\n      }\n    } else if (simpleSelector.startsWith('.')) {\n      const classNames = (node.getAttribute('class') || '').split(' ')\n      if (!classNames.includes(simpleSelector.slice(1))) {\n        return false\n      }\n    } else if (simpleSelector.startsWith('[')) {\n      const attrSelectorMatch = simpleSelector.match(/^\\[([\\w-]+)(=\"([^\"]*)\")?\\]$/)\n      if (attrSelectorMatch) {\n        const attrName = attrSelectorMatch[1]\n        const attrValue = attrSelectorMatch[3]\n        const actualValue = node.getAttribute(attrName)\n\n        if (typeof attrValue === 'undefined') {\n          if (actualValue === undefined) {\n            return false\n          }\n        } else {\n          if (actualValue !== attrValue) {\n            return false\n          }\n        }\n      } else {\n        return false\n      }\n    } else {\n      if (node.nodeName !== simpleSelector) {\n        return false\n      }\n    }\n  }\n\n  return true\n}\n\nexport function parseHTML(html: string): HTMLNode[] {\n  const nodes: HTMLNode[] = []\n  const stack: HTMLNode[] = []\n\n  while (html) {\n    const openTagMatch = html.match(/^<([\\w-]+)(\\s[^>]*)?>/)\n    const closingTagMatch = html.match(/^<\\/([\\w-]+)>/)\n\n    if (openTagMatch) {\n      const nodeName = openTagMatch[1]\n      const attrsStr = openTagMatch[2] || ''\n      const attrs =\n        attrsStr.match(/([\\w-]+)(=\"([^\"]*)\")?/g)?.map((attr) => {\n          const [_, name, , value] = attr.match(/([\\w-]+)(=\"([^\"]*)\")?/)\n          return { name, value: unescapeHTML(value || '') }\n        }) || []\n\n      const node = new HTMLNode(nodeName, 1)\n      node.attributes = attrs\n      if (stack.length > 0) {\n        const parentNode = stack[stack.length - 1]\n        parentNode.childNodes.push(node)\n        node.parentNode = parentNode\n      } else {\n        nodes.push(node)\n      }\n      stack.push(node)\n      html = html.slice(openTagMatch[0].length)\n    } else if (closingTagMatch) {\n      stack.pop()\n      html = html.slice(closingTagMatch[0].length)\n    } else {\n      const textEnd = html.indexOf('<')\n      const textContent = html.slice(0, textEnd !== -1 ? textEnd : undefined)\n      const textNode = new HTMLNode('#text', 3)\n      textNode.textContent = textContent\n      if (stack.length > 0) {\n        const parentNode = stack[stack.length - 1]\n        parentNode.childNodes.push(textNode)\n        textNode.parentNode = parentNode\n      } else {\n        nodes.push(textNode)\n      }\n      html = html.slice(textContent.length)\n    }\n  }\n\n  return nodes\n}\n\nexport function escapeHTML(input: string): string {\n  return input\n    .replace(/&/g, '&amp;')\n    .replace(/</g, '&lt;')\n    .replace(/>/g, '&gt;')\n    .replace(/\"/g, '&quot;')\n    .replace(/'/g, '&#x27;')\n}\n\nfunction unescapeHTML(input: string): string {\n  return input\n    .replace(/&amp;/g, '&')\n    .replace(/&lt;/g, '<')\n    .replace(/&gt;/g, '>')\n    .replace(/&quot;/g, '\"')\n    .replace(/&#x27;/g, \"'\")\n}\n\nexport function serializeHTML(nodes: HTMLNode[]): string {\n  return nodes\n    .map((node) => {\n      if (node.nodeType === 3) {\n        return node.textContent || ''\n      }\n\n      const { nodeName, attributes } = node\n      const serializedAttributes = attributes\n        .map(({ name, value }) => ` ${name}=\"${escapeHTML(String(value))}\"`)\n        .join('')\n      const serializedChildren = serializeHTML(node.childNodes)\n      if (['img', 'input', 'br'].includes(nodeName)) {\n        return `<${nodeName}${serializedAttributes} />`\n      } else {\n        return `<${nodeName}${serializedAttributes}>${serializedChildren}</${nodeName}>`\n      }\n    })\n    .join('')\n}\n\nexport function renderHTMLContent(template: string, data?: Datascopes, config?: FEAASCustomizations) {\n  const newTemplate = config?.processTemplate?.(null, template, data) || template\n  const nodes = parseHTML(newTemplate)\n  return renderDOMElement(nodes[0] as unknown as HTMLElement, data, config).outerHTML\n}\n", "export function observeDOMElement(element: HTMLElement) {\n  const observer = new element.ownerDocument.defaultView.MutationObserver((changes) => {\n    changes.forEach((change) => {\n      const target = change.target as HTMLElement\n      const src = target.getAttribute('data-embed-src')\n      if (src) {\n        loadScript(target, src)\n      }\n\n      if (change.addedNodes) {\n        change.addedNodes.forEach((node) => {\n          if (node.nodeType == 1) autoloadScripts(node as HTMLElement, false)\n        })\n      }\n    })\n  })\n  observer.observe(element, { attributes: true, subtree: true, childList: true })\n  return observer\n}\n\nexport function autoloadScripts(element: HTMLElement, observe = true) {\n  const embeds = element.querySelectorAll('[data-embed-src]')\n  for (var i = 0; i < embeds.length; i++) {\n    const embed = embeds[i]\n    loadScript(embed as HTMLElement, embed.getAttribute('data-embed-src'))\n  }\n  if (observe) return observeDOMElement(element)\n}\n\nexport function loadScript(element: HTMLElement, src: string) {\n  for (var p = element; p; p = p.parentElement as HTMLElement) {\n    if (!p.parentElement) {\n      const scripts = p.querySelectorAll('script')\n      for (var i = 0; i < scripts.length; i++) {\n        if (scripts[i].getAttribute('src') == src) {\n          return true\n        }\n      }\n      if (p.tagName == 'HTML') p = p.querySelector('head') || p\n      const script = p.ownerDocument.createElement('script')\n      script.setAttribute('type', 'module')\n      script.setAttribute('src', src)\n      p.appendChild(script)\n      break\n    }\n  }\n}\n", "import { FEAASCDNComponentProps } from '../cdn.js'\nimport { Datascopes, normalizeCollectionScope, queryScopes, serializeCH1RichText } from './data.js'\nimport { parseHTML } from './html.js'\nimport { loadScript } from './scripts.js'\n\nexport interface FEAASCustomizations {\n  processTemplate?: (element: HTMLElement, template: string, data: any) => string\n  processData?: (element: HTMLElement, data: any) => any\n  processValue?: (element: HTMLElement, property: string, value: any) => any\n  shouldRepeat?: (element: HTMLElement, value: any) => boolean\n  onRender?: (element: HTMLElement, data: any) => void\n}\n\nexport interface ExplicitTemplate {\n  template: string\n}\n\nexport type FEAASComponentProps<T = Datascopes> = Partial<ExplicitTemplate> & {\n  data?: T\n} & (ExplicitTemplate | FEAASCDNComponentProps) &\n  FEAASCustomizations\n\nfunction getDOMCollectionIndex(element: HTMLElement) {\n  const datascope = element.getAttribute('data-path-scope')\n  var index = 0\n  for (var p = element; (p = <HTMLElement>p.previousElementSibling); ) {\n    if (p.getAttribute('data-path-scope') == datascope) {\n      index++\n    }\n  }\n  return index\n}\n\nfunction updateDOMClones(element: HTMLElement, targetCount: number, config?: FEAASCustomizations) {\n  const datascope = element.getAttribute('data-path-scope')\n  if (datascope == null) {\n    return\n  }\n  var index = getDOMCollectionIndex(element)\n  if (index != 0) {\n    return\n  }\n\n  const parentElement = element.parentNode as HTMLElement\n  if (parentElement == null) {\n    return\n  }\n\n  /*dont remove first element, just hide it*/\n  if (targetCount == 0) {\n    element.setAttribute('hidden', 'hidden')\n  } else if (element.getAttribute('hidden') != null) {\n    element.removeAttribute('hidden')\n  }\n\n  var count = index + 1\n  var last = element\n  for (var n = element; (n = <HTMLElement>n.nextElementSibling); ) {\n    if (n.getAttribute('data-path-scope') == datascope) {\n      count++\n      last = n\n    }\n  }\n  /* add missing clones */\n  for (var i = count; i < targetCount; i++) {\n    parentElement.insertBefore(last.cloneNode(true), last.nextElementSibling)\n  }\n  /* remove excessive clones fron previous renders */\n  for (var i = Math.max(1, targetCount); i < count; i++) {\n    last = <HTMLElement>last.previousElementSibling\n    parentElement.removeChild(<HTMLElement>last.nextElementSibling)\n  }\n}\n\nexport function setDOMAttribute(element: HTMLElement, attribute: string, value: any, config?: FEAASCustomizations) {\n  if (!element) return\n  var target = element\n  if (value?.type == 'doc' && Array.isArray(value.content)) value = serializeCH1RichText(value)\n  if (config?.processValue) {\n    value = config?.processValue(element, attribute, value)\n  }\n  var prop = attribute.replace('data-path-', '')\n  if (attribute == 'data-path-src') {\n    target = element.tagName == 'IMG' ? element : <HTMLElement>element.querySelector('img, video')\n  } else if (attribute == 'data-path-href') {\n    target = element.querySelector('a') || element.closest('a')\n  } else if (attribute == 'data-path-alt') {\n    target = element.querySelector('img, picture')\n  } else if (attribute == 'data-path-hidden') {\n    value = !value ? true : null\n  } else if (attribute == 'data-path' || attribute == 'data-embed-html' || attribute == 'html') {\n    prop = 'innerHTML'\n  } else if (attribute == 'data-embed-src') {\n    loadScript(element, value)\n  } else if (attribute == 'data-path-attributes') {\n    const oldKeys = element.getAttribute('data-attributes-keys')?.split(',').filter(Boolean) || []\n    if (!Array.isArray(value))\n      for (var property in value) {\n        var subvalue = value[property]\n        setDOMAttribute(\n          element,\n          property,\n          typeof subvalue == 'object' && subvalue ? JSON.stringify(subvalue) : subvalue,\n          config\n        )\n      }\n    for (var i = 0; i < oldKeys.length; i++) {\n      if (value == null || !(oldKeys[i] in value)) {\n        setDOMAttribute(element, oldKeys[i], null, config)\n      }\n    }\n    setDOMAttribute(element, 'data-attributes-keys', Object.keys(value || {}).join(','))\n    return\n  }\n  if (typeof value == 'boolean') {\n    value = value ? '' : null\n  }\n  if (!target) return\n\n  var placeholder = String(element.getAttribute('data-path-placeholder') || target[prop as keyof HTMLElement])\n\n  if (value != null) {\n    if (prop == 'innerHTML') {\n      if (target.innerHTML != value) {\n        target.innerHTML = value\n      }\n    } else {\n      if (target.getAttribute(prop) != value) {\n        target.setAttribute(prop, value)\n      }\n    }\n  } else {\n    if (prop == 'innerHTML') {\n      target.innerHTML = placeholder\n    } else {\n      target.removeAttribute(prop)\n    }\n  }\n}\n\n// order in which attributes are proccesed. Rightmost are more important\nvar sortOrder = ['data-attributes-keys', 'data-path-attributes', 'data-path-scope']\nexport function renderDOMElement(\n  input: HTMLElement | DocumentFragment,\n  datascopes?: any,\n  config?: FEAASCustomizations,\n  isNested?: boolean\n) {\n  const element = <HTMLElement>input\n  if (!isNested) {\n    datascopes = config?.processData?.(element, datascopes) || datascopes\n  }\n  if (element.nodeType == 1) {\n    const datascope = element.getAttribute('data-path-scope')\n    if (datascope) {\n      const index = getDOMCollectionIndex(element)\n      const collection = queryScopes(datascopes, datascope, false) || []\n      if (index == 0) {\n        updateDOMClones(element, config?.shouldRepeat?.(element, collection) === false ? 1 : collection.length, config)\n      }\n\n      datascopes = {\n        ...datascopes,\n        [normalizeCollectionScope(datascope)]: collection[index]\n      }\n    }\n    const attrs = Array.prototype.slice.call(element.attributes).sort((a: Attr, b: Attr) => {\n      return sortOrder.indexOf(a.name) - sortOrder.indexOf(b.name)\n    })\n    for (var i = 0; i < attrs.length; i++) {\n      const { name, value: datapath } = attrs[i]\n      if (name.startsWith('data-path') && name != 'data-path-scope') {\n        setDOMAttribute(element, name, queryScopes(datascopes, datapath, true), config)\n      }\n      if (name == 'data-embed-src') {\n        setDOMAttribute(element, name, element.getAttribute(name), config)\n      }\n    }\n  }\n  for (var i = 0, child: Node; (child = element.childNodes[i++]); ) {\n    if (isElement(child)) {\n      renderDOMElement(child, datascopes, config, true)\n    }\n  }\n  if (!isNested) {\n    config?.onRender?.(element, datascopes)\n  }\n  return element\n}\nfunction isElement(node: Node): node is HTMLElement {\n  return node.nodeType == 1\n}\n\nexport function renderDOMContent(root: HTMLElement, template: string, data?: Datascopes, config?: FEAASCustomizations) {\n  const newTemplate = config?.processTemplate?.(root, template, data) || template\n  root.innerHTML = newTemplate\n  root.classList.add('-feaas')\n  // fixme, jss needs to assign theme classes to component instead\n  const anchor = root.closest('.component.feaas') || root\n  if (anchor.className.includes('-theme--')) {\n    for (var i = 0, child: Node; (child = root.childNodes[i++]); ) {\n      if (isElement(child)) {\n        child.className = child.className.replace(/(\\s|^)-theme--[^\\s]+\\s*/g, '$1')\n      }\n    }\n  }\n  return renderDOMElement(root, data, config)\n}\n\nexport function renderHTMLContent(template: string, data?: Datascopes, config?: FEAASCustomizations, fakeDOM = false) {\n  const newTemplate = config?.processTemplate?.(null, template, data) || template\n  if (typeof document === 'undefined' || fakeDOM) {\n    const nodes = parseHTML(newTemplate)\n    return renderDOMElement(nodes[0] as unknown as HTMLElement, data, config).outerHTML\n  } else {\n    const root = document.createElement('div')\n    root.innerHTML = newTemplate\n    renderDOMElement(root, data, config)\n    return root.innerHTML\n  }\n}\n", "import { ControlledPromise } from './utils/promise.js'\n\n/**\n * Utility to cache-bust static files. It relies on reading Date header to detect cached response, so it requires CORS\n * settings to be set.\n *\n * It accepts validator function that determines if response is usable. If response was pulled from cache and is valid,\n * the optional callback function is fired right away. Then HEAD request is made bypassing the cache, to see if the\n * response has an newer Last-Modified header. In case it does and it passes validation, third request is fired that\n * actually fetches the new content and callback is invoked the second time.\n *\n * It works as promise, but also accepts callback to use cached blobs mid-flight and have access to headers. Any network\n * errors will not be caught. Function throws when unable to fetch valid response.\n */\nconst phases = ['initial', 'check', 'updated'] as const\nexport type ValidatableRequestPhase = typeof phases[number]\nexport type FetchCache = Record<string, FetchCacheRequest>\nexport interface ValidatableRequest {\n  url: Parameters<typeof fetch>[0]\n  options?: Parameters<typeof fetch>[1]\n  validator?: (resposne: Response) => boolean\n  callback?: (response: Response, status: ValidatableRequestPhase, isCached: boolean) => any\n  isCached?: boolean\n  response?: Response\n  cache?: FetchCache\n}\n\nexport type FetchCacheRequest = {\n  phase: ValidatableRequestPhase\n  initial: ControlledPromise<Response>\n  check: ControlledPromise<Response>\n  updated: ControlledPromise<Response>\n  final: ControlledPromise<Response>\n}\n\nexport var fetchCache: Record<string, FetchCacheRequest> = {}\nexport function clearFetchCache() {\n  fetchCache = {}\n}\n\nexport async function fetchAndRevalidate(\n  url: ValidatableRequest['url'],\n  options?: ValidatableRequest['options'],\n  validator?: ValidatableRequest['validator'],\n  callback?: ValidatableRequest['callback'],\n  cache: FetchCache = fetchCache\n) {\n  // make request as usual, see if there's cached version of an asset\n  return fetchWithCacheAwareness({ url, options, validator, callback, cache })\n    .then(fetchToValidateCache)\n    .then((result) => result.response)\n}\n\nexport function getFetchCache(url: Parameters<typeof fetch>[0], dontCreate = false) {\n  const key = String(url).replace('?head', '')\n  var cache = fetchCache[key]\n  if (!cache && !dontCreate) {\n    cache = fetchCache[key] = {\n      phase: null,\n      initial: ControlledPromise(),\n      check: ControlledPromise(),\n      updated: ControlledPromise(),\n      final: ControlledPromise()\n    }\n  }\n  return cache\n}\n\nexport async function fetchWithCacheAwareness(\n  { url, options, validator, callback, cache }: ValidatableRequest,\n  phase: ValidatableRequestPhase = 'initial'\n) {\n  const date = new Date()\n  if (cache != null) {\n    var cachedRequest = getFetchCache(url)\n    if (phases.indexOf(cachedRequest.phase) >= phases.indexOf(phase)) {\n      var promise = cachedRequest[phase]\n    } else {\n      cachedRequest.phase = phase\n    }\n  }\n  const response = await (promise || fetch(url, options))\n  if (!promise && cachedRequest) {\n    if (!response.ok) {\n      cachedRequest[phase].reject(new Error('Fetch failed'))\n    } else {\n      cachedRequest[phase].resolve(response)\n    }\n  }\n  if (!response.ok) throw new Error('Fetch failed')\n  if (validator?.(response) === false) throw new Error('Response is not valid')\n  // see if response was pulled from cache\n  const isCached =\n    new Date(response.headers.get('date')) < date ||\n    (promise && phase == 'initial' && (cachedRequest.phase == 'updated' || cachedRequest.phase == 'check'))\n  await callback?.(response, phase, isCached)\n  return {\n    url,\n    options,\n    isCached,\n    response,\n    validator,\n    callback,\n    cache\n  }\n}\n\nexport async function fetchToValidateCache(\n  request: ValidatableRequest & Required<Pick<ValidatableRequest, 'response'>>\n) {\n  const { url, isCached, options, validator, response, cache } = request\n  if (isCached) {\n    // check if response was stale by sending quick HEAD request busting cache\n    const { response: head } = await fetchWithCacheAwareness(\n      {\n        url: url + '?head',\n        options: {\n          ...options,\n          method: 'HEAD',\n          cache: 'no-cache'\n        },\n        validator,\n        cache\n      },\n      'check'\n    )\n\n    // there's a newer version of the file that we may fetch\n    if (head.headers.get('last-modified') != response.headers.get('last-modified')) {\n      // otherwise the new resource has to be re-fetched\n      return fetchBypassingCache(request)\n    }\n  }\n  return request\n}\n\nexport async function fetchBypassingCache(request: ValidatableRequest) {\n  return fetchWithCacheAwareness(\n    {\n      ...request,\n      options: {\n        ...request.options,\n        cache: 'reload'\n      }\n    },\n    'updated'\n  )\n}\n", "import {\n  fetchAndRevalidate,\n  fetchWithCacheAwareness,\n  fetchBypassingCache,\n  fetchToValidateCache,\n  ValidatableRequestPhase\n} from './fetch.js'\n\nexport const DEFAULT_CDN_URL = `https://feaas.blob.core.windows.net`\nexport type FEAASCDNComponentParams = {\n  cdn?: string\n  revision?: 'staged' | 'published' | 'saved' | number\n  library: string\n  component: string\n  version?: string\n\n  /** @deprecated Use `cdn` instead */\n  hostname?: string\n}\nexport type FEAASCDNComponentSource = {\n  src: string\n}\nexport type FEAASCDNComponentParamsCustomizations = {\n  instance?: string\n}\nexport type FEAASCDNComponentProps = (FEAASCDNComponentParams | FEAASCDNComponentSource) &\n  FEAASCDNComponentParamsCustomizations\n\nexport interface FEAASCDNStylesheetParams {\n  cdn?: string\n  library: string\n  revision?: 'staged' | 'published' | 'saved' | number\n\n  /** @deprecated Use `cdn` instead */\n  hostname?: string\n}\n\nexport type FEAASCDNStylesheetSource = {\n  src: string\n}\nexport type FEAASCDNStylesheetProps = FEAASCDNStylesheetParams | FEAASCDNStylesheetSource | string\n\nexport function parseComponentSource(source: string): FEAASCDNComponentParams {\n  const match = source.match(\n    /^(?:(.*?)\\/components)?\\/?([^\\/]+)\\/([^\\/]+)(?:\\/([^\\/]+)(?:\\/(published|staged|saved|\\d+)(?:\\.html?)?)?)?$/\n  )\n  if (match) {\n    var [, cdn, library, component, version, revision] = match\n    return { cdn, library, component, version, revision: revision as any }\n  }\n}\nexport function getComponentSource(props: FEAASCDNComponentParams) {\n  if (!props || !props.library || !props.component)\n    throw new Error('Component requires `library` and `component` properties')\n  return `${props.cdn && props.cdn != DEFAULT_CDN_URL ? `${props.cdn}/components` : ''}/${props.library}/${\n    props.component\n  }/${\n    !props.version || (props.version == 'responsive' && (!props.revision || props.revision == 'published'))\n      ? ''\n      : props.version\n  }/${!props.revision || props.revision == 'published' ? '' : props.revision}`.replace(\n    /(^\\/|\\/$|\\/\\/)(?!.+\\/components\\/)/g,\n    ''\n  )\n}\n\nexport function getStylesheetSource(props: FEAASCDNStylesheetParams) {\n  return `${props.cdn && props.cdn != DEFAULT_CDN_URL ? `${props.cdn}/styles/` : ''}${props.library}/${\n    !props.revision || props.revision == 'published' ? '' : props.revision\n  }`.replace(/\\/$|\\/\\/(?!.+\\/styles\\/)/g, '')\n}\n\nexport function parseStylesheetSource(source: string): FEAASCDNStylesheetParams {\n  const match = source.match(/^(?:(.*?)\\/styles\\/)?([^\\/]+)(?:\\/(published|staged|saved|\\d+)(?:.css)?)?$/)\n  if (match) {\n    var [, cdn, library, revision] = match\n    return { cdn, library, revision: revision as any }\n    // try parsing it as component url\n  } else {\n    const parsed = parseComponentSource(source) as Record<string, string>\n    if (parsed) {\n      var { cdn, library, revision } = parsed\n      if (revision?.match(/\\d/)) revision = undefined\n      return { cdn, library, revision: revision as any }\n    }\n  }\n}\nexport function getComponentURL(props: FEAASCDNComponentProps | string) {\n  if (typeof props == 'string') {\n    props = { src: props }\n  }\n  if ('src' in props) {\n    props = {\n      ...parseComponentSource(props.src)\n    }\n  }\n  return `${props.cdn || props.hostname || DEFAULT_CDN_URL}/components/${props.library}/${props.component}/${\n    props.version\n  }/${props.revision || 'published'}.html`\n}\n\nexport function getStylesheetURL(props: FEAASCDNStylesheetProps) {\n  if (typeof props == 'string') {\n    props = { src: props }\n  }\n  if ('src' in props) {\n    props = {\n      ...parseStylesheetSource(props.src)\n    }\n  }\n  return `${props.cdn || props.hostname || DEFAULT_CDN_URL}/styles/${props.library}/${\n    props.revision || 'published'\n  }.css`\n}\n\nexport async function fetchAndRevalidateComponent(\n  props: FEAASCDNComponentProps,\n  callback?: (html: string) => void,\n  dontRevalidate = false\n) {\n  const onlyIfNotDeleted = (response: Response) => {\n    return response.headers.get('x-ms-meta-versionDeletedAt') == null\n  }\n  const parseResponse = (response: Response) => {\n    return response.clone().text().then(callback)\n  }\n\n  // Fetch two requests in parallel: One optimistically checking if component was forked,\n  // and another checking original definition of a component\n  const results = await Promise.all([\n    props.instance &&\n      fetchWithCacheAwareness({\n        options: {\n          headers: {\n            Accept: 'text/html'\n          },\n          credentials: 'omit'\n        },\n        url: getComponentURL({ ...props, version: props.instance }),\n        validator: onlyIfNotDeleted\n      }).catch((e) => e as Error),\n    fetchWithCacheAwareness({ url: getComponentURL(props), validator: onlyIfNotDeleted }).catch((e) => e as Error)\n  ])\n  const result = results.find((result) => result && 'isCached' in result && result)\n  if (!result || result instanceof Error) {\n    const error = results.find((result) => result && result instanceof Error)\n    throw error || new Error('Can not fetch component')\n  }\n  if (results[0] == result) {\n    console.log('Using fork!', results)\n  }\n  await parseResponse(result.response)\n  if (dontRevalidate) return result\n  return fetchToValidateCache({ ...result, callback: parseResponse }).catch((e) => {\n    if (results[0] == result) {\n      fetchBypassingCache({ ...result, callback: null, validator: null })\n      console.log('Fork was deleted')\n      // forked version was cached, but it's now deleted\n      if (!(results[1] instanceof Error)) {\n        parseResponse(results[1].response)\n        return fetchToValidateCache({ ...results[1], callback: parseResponse })\n      }\n    }\n    throw e\n  })\n}\n\n/** Fetches HTML of a component. */\nexport async function fetchComponent(props: FEAASCDNComponentProps | string) {\n  if (typeof props == 'string') props = { src: props }\n  var template: string\n  const { response } = await fetchAndRevalidateComponent(\n    props,\n    (result) => {\n      template = result\n    },\n    true\n  )\n  return { ...props, template, lastModified: response.headers.get('last-modified') }\n}\n\nexport type ValidatableStylesheetCallback = (css: string, phase: ValidatableRequestPhase) => void\nexport async function fetchAndRevalidateStylesheet(\n  props: FEAASCDNStylesheetProps,\n  callback: ValidatableStylesheetCallback\n) {\n  if (typeof props == 'string') props = { src: props }\n  return fetchAndRevalidate(\n    getStylesheetURL(props),\n    {\n      headers: {\n        Accept: 'text/css'\n      },\n      credentials: 'omit'\n    },\n    (response) => {\n      return response.headers.get('x-ms-meta-deletedAt') == null\n    },\n    (response, phase) => {\n      return response\n        .clone()\n        .text()\n        .then((text) => callback(text, phase))\n    }\n  )\n}\n", "import {\n  FEAASCDNStylesheetProps,\n  fetchAndRevalidateStylesheet,\n  getStylesheetURL,\n  ValidatableStylesheetCallback\n} from '../cdn.js'\n\nexport function renderStylesheet(props: FEAASCDNStylesheetProps, style?: HTMLStyleElement) {\n  renderStylesheetPromise(props, (style ||= document.createElement('style')))\n  return style\n}\n\nexport function renderStylesheetPromise(props: FEAASCDNStylesheetProps, stylesheet?: HTMLStyleElement) {\n  stylesheet ||= document.createElement('style')\n  return fetchAndRevalidateStylesheet(props, (cssText, phase) => {\n    stylesheet.textContent = cssText\n  }).then(() => stylesheet)\n}\n\nexport function loadStylesheet(props: FEAASCDNStylesheetProps, callback?: ValidatableStylesheetCallback) {\n  var foundStylesheet = findStylesheet(props) as HTMLStyleElement\n  if (!foundStylesheet) {\n    var createdStylesheet = createStylesheet(props)\n  }\n  return fetchAndRevalidateStylesheet(props, (cssText, phase) => {\n    if (createdStylesheet) {\n      createdStylesheet.textContent = cssText\n    }\n    callback?.(cssText, phase)\n  }).then(() => foundStylesheet || createdStylesheet)\n}\n\nexport function loadStylesheetAllowStale(props: FEAASCDNStylesheetProps) {\n  return new Promise((resolve, reject) => {\n    loadStylesheet(props, resolve).catch(reject)\n  })\n}\n\nexport function findStylesheet(props: FEAASCDNStylesheetProps) {\n  return document.head.querySelector(`style[data-href=\"${getStylesheetURL(props)}\"]`)\n}\n\nexport function createStylesheet(props: FEAASCDNStylesheetProps) {\n  const url = getStylesheetURL(props)\n  const stylesheet = document.createElement('style')\n  stylesheet.setAttribute('data-href', url)\n  document.head.appendChild(stylesheet)\n  return stylesheet\n}\n", "import { fetchAndRevalidateComponent } from '../cdn.js'\nimport { Datascopes } from './data.js'\nimport { FEAASComponentProps, renderDOMContent, renderDOMElement } from './rendering.js'\n\nexport function renderComponentElement(content: string, datasources?: Datascopes) {\n  const wrapper = document.createElement('div')\n  wrapper.innerHTML = content\n  const fragment = document.createDocumentFragment()\n  while (wrapper.firstChild) {\n    fragment.appendChild(wrapper.firstChild)\n  }\n  renderDOMElement(fragment, datasources)\n  return wrapper\n}\n\nexport function renderComponent(props: FEAASComponentProps, root?: HTMLElement) {\n  renderComponentPromise(props, (root ||= document.createElement('div')))\n  return root\n}\n\nexport async function renderComponentPromise(props: FEAASComponentProps, root?: HTMLElement) {\n  root ||= document.createElement('div')\n  if (!root.childNodes.length) {\n    if ('template' in props) {\n      return renderDOMContent(root, props.template, props.data, props)\n    } else {\n      return fetchAndRevalidateComponent(props, (template) => {\n        return renderDOMContent(root, template, props.data, props)\n      }).then(() => root)\n    }\n    /* update element with new data */\n  } else {\n    return renderDOMElement(root, props.data, props)\n  }\n}\n", "import { DEFAULT_CDN_URL, FEAASCDNComponentParams, fetchAndRevalidateComponent, parseComponentSource } from '../cdn.js'\nimport { renderDOMContent, renderDOMElement } from '../dom/rendering.js'\nimport { loadStylesheetAllowStale } from '../headless.js'\nimport { FEAASBase } from './FEAASBase.js'\n\nexport function FEAASComponentsProps(element: FEAASBase = this) {\n  let data: any\n  const src = element.getAttribute('src')\n  if (src) {\n    const parsed = parseComponentSource(src)\n    if (!parsed) throw new Error(`Could not parse FEAAS Component source: ${src}`)\n    var { cdn, library, component, version, revision } = parsed\n  }\n  const dataValue = element.getAttribute('data')\n  if (dataValue != null && dataValue != '') {\n    try {\n      data = typeof dataValue == 'string' ? JSON.parse(dataValue) : {}\n    } catch (e) {}\n  }\n  return {\n    data: data || {},\n    cdn: element.getContextAttribute('cdn') ?? cdn ?? DEFAULT_CDN_URL,\n    library: element.getAttribute('library') ?? library,\n    component: element.getAttribute('component') ?? component,\n    version: element.getAttribute('version') ?? version ?? 'responsive',\n    revision: (element.getAttribute('revision') ?? revision ?? 'published') as FEAASCDNComponentParams['revision'],\n    hostname: element.getAttribute('hostname'),\n    template: element.getAttribute('template'),\n    instance: element.getAttribute('instance'),\n    editable: element.getAttribute('editable') != null,\n    suspended: element.getAttribute('suspended') != null,\n    lastModified: element.getAttribute('last-modified'),\n    withStylesheet: element.getAttribute('with-stylesheet') != 'false'\n  }\n}\nexport type FEAASComponentsProps = ReturnType<typeof FEAASComponentsProps>\nexport class FEAASComponent extends FEAASBase<FEAASComponentsProps, string> {\n  static observedAttributes = [\n    'library',\n    'component',\n    'version',\n    'revision',\n    'hostname',\n    'cdn',\n    'template',\n    'data',\n    'instance',\n    'editable',\n    'with-stylesheet'\n  ]\n\n  defaultProps = {\n    cdn: DEFAULT_CDN_URL,\n    revision: 'published',\n    version: 'responsive',\n    withStylesheet: true,\n    editable: false,\n    suspended: false\n  } as Partial<FEAASComponentsProps>\n\n  needsRefresh: boolean\n  setData(data: any) {\n    this.set({ data })\n  }\n\n  getProps() {\n    return FEAASComponentsProps(this)\n  }\n\n  attributeChangedCallback(name: string, oldValue: string, newValue: string): void {\n    if (oldValue === newValue) return\n    // force component to be refreshed\n    if (name == 'library' || name == 'component' || name == 'revision' || name == 'version') {\n      this.payload = undefined\n    }\n    this.needsRefresh = true\n    super.attributeChangedCallback(name, oldValue, newValue)\n  }\n\n  getEditor(): any {\n    return (document.querySelector('feaas-context') as FEAASBase)?.refs.editor\n  }\n\n  constructor() {\n    super()\n    this.addEventListener('click', () => {\n      if (this.props.editable) {\n        this.edit()\n      }\n    })\n  }\n\n  edit() {\n    const editor = this.getEditor()\n    if (editor?.setTarget(this)) {\n      editor.open()\n      return true\n    }\n  }\n\n  /* Check if component is a repeated clone, and return the original */\n  getOriginal() {\n    const scope = this.getAttribute('data-path-scope')\n    if (!scope) return\n    for (var current = this as Element; (current = current.previousElementSibling); ) {\n      if (current.getAttribute('data-path-scope') == scope) {\n        var last = current\n      } else {\n        break\n      }\n    }\n    return last as FEAASComponent\n  }\n\n  isReadyToLoad() {\n    return (\n      super.isReadyToLoad() && this.props.library != null && this.props.component != null && this.props.version != null\n    )\n  }\n\n  onLoad = (html: string) => {\n    this.payload = html\n    this.advance()\n  }\n\n  async load() {\n    // defer loading to original element\n    if (this.getOriginal()) {\n      return\n    }\n    if (this.props.withStylesheet) {\n      var stylesheetPromise = loadStylesheetAllowStale({ ...this.props, revision: 'published' }).then(() => {\n        stylesheetPromise = null\n        if (this.payload) {\n          this.onLoad(this.payload)\n        }\n      })\n    }\n    return Promise.all([\n      stylesheetPromise,\n      fetchAndRevalidateComponent(this.props, (html) => {\n        this.payload = html\n        if (!stylesheetPromise) this.onLoad(html)\n      })\n    ]).then(() => this.payload)\n  }\n\n  update() {\n    if (Array.from(this.children).filter((c) => c.tagName != 'BR').length > 0 && !this.needsRefresh) {\n      renderDOMElement(this, this.props.data)\n    } else {\n      this.needsRefresh = true\n      // defer rendering to original element\n      if (this.getOriginal()) {\n        return\n      }\n      renderDOMContent(this, this.payload, this.props.data)\n    }\n  }\n}\n\ndeclare global {\n  namespace JSX {\n    interface IntrinsicElements {\n      'feaas-component': {\n        data?: any\n        template?: string\n        instance?: string\n        editable?: boolean\n        children?: any\n        dangerouslySetInnerHTML?: { __html: string }\n        'last-modified'?: string\n        'with-stylesheet'?: 'false' | 'true' | ''\n      } & (\n        | {\n            /** @deprecated Use cdn instead */\n            hostname?: string\n            cdn?: string\n            library: string\n            component: string\n            version?: string\n            revision?: FEAASComponentsProps['revision']\n          }\n        | { src: string }\n        | { template: string }\n      )\n    }\n  }\n}\nFEAASComponent.register('feaas-component')\n\nexport { FEAASComponent as Component, FEAASComponentsProps as ComponentProps }\n", "import { FEAASBase } from './FEAASBase.js'\n\nexport function FEAASLoaderProps(element: HTMLElement = this) {\n  return {\n    opacity: element?.getAttribute('opacity') ? parseFloat(element?.getAttribute('opacity')) : 1,\n    hidden: element?.getAttribute('hidden') != null\n  }\n}\ntype FEAASLoaderProps = ReturnType<typeof FEAASLoaderProps>\n\nexport class FEAASLoader extends FEAASBase<FEAASLoaderProps, string> {\n  stylesheet: HTMLStyleElement\n  loader: HTMLDivElement\n\n  getProps() {\n    return FEAASLoaderProps(this)\n  }\n\n  defaultProps = {\n    hidden: false\n  } as Partial<FEAASLoaderProps>\n\n  static observedAttributes = ['hidden', 'opacity']\n\n  attributeChangedCallback(name: string, oldValue: string, newValue: string): void {\n    if (oldValue === newValue) return\n    if (name == 'hidden') {\n      this.style.setProperty('display', 'block', 'important')\n      this.style.setProperty('transition', 'opacity 0.3s', 'important')\n      if (newValue) {\n        this.style.setProperty('opacity', '0', 'important')\n        this.style.pointerEvents = 'none'\n      } else {\n        this.style.setProperty('opacity', '1', 'important')\n        this.style.pointerEvents = 'all'\n      }\n    }\n    return super.attributeChangedCallback(name, oldValue, newValue)\n  }\n\n  connectedCallback() {\n    this.payload = null\n    super.connectedCallback()\n    this.attributeChangedCallback('hidden', this.getAttribute('hidden'), this.getAttribute('hidden'))\n    this.stylesheet = document.createElement('style')\n    this.stylesheet.textContent = `\n  #loader {\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    background: #f6f6ff;\n    z-index: 1000;\n  }\n  @keyframes loader-circular-track {\n    0% {\n      stroke-dasharray: 1, 400;\n      stroke-dashoffset: 0;\n    }\n    50% {\n      stroke-dasharray: 400, 400;\n      stroke-dashoffset: -100;\n    }\n    100% {\n      stroke-dasharray: 400, 400;\n      stroke-dashoffset: -260;\n    }\n  }\n  \n  @keyframes loader-circular-spinner {\n    0% {\n      transform: rotate(0deg);\n    }\n  \n    100% {\n      transform: rotate(360deg);\n    }\n  }\n  #loader .spinner {\n    width: 48px;\n    height: 48px;\n  }\n  `\n    this.loader = document.createElement('div')\n    this.loader.id = 'loader'\n    this.loader.innerHTML = `\n  <div class=\"spinner\">\n    <svg\n      viewBox=\"0 0 100 100\"\n      style=\"\n        animation: 2s linear 0s infinite normal none running loader-circular-spinner;\n        display: block;\n        width: 48px;\n        height: 48px;\n      \"\n    >\n      <circle fill=\"transparent\" cx=\"50\" cy=\"50\" r=\"42\" stroke=\"rgba(0,0,0,0.1)\" stroke-width=\"10px\"></circle>\n      <circle\n        fill=\"transparent\"\n        stroke=\"#5548D9\"\n        cx=\"50\"\n        cy=\"50\"\n        r=\"42\"\n        stroke-width=\"10px\"\n        stroke-linecap=\"round\"\n        style=\"animation: 1.5s linear 0s infinite normal none running loader-circular-track\"\n      ></circle>\n    </svg>\n  </div>`\n    this.getRoot().appendChild(this.stylesheet)\n    this.getRoot().appendChild(this.loader)\n  }\n\n  update() {\n    this.loader.style.opacity = String(this.props.opacity)\n  }\n}\n\ndeclare global {\n  namespace JSX {\n    interface IntrinsicElements {\n      'feaas-loader': any\n    }\n  }\n}\nFEAASLoader.register('feaas-loader')\n\nexport { FEAASLoader as Loader }\n", "import { DEFAULT_CDN_URL, FEAASCDNStylesheetParams, parseStylesheetSource } from '../cdn.js'\nimport { loadStylesheet } from '../dom/stylesheet.js'\nimport { FEAASBase } from './FEAASBase.js'\n\nexport function FEAASStylesheetProps(element: FEAASBase = this) {\n  const src = element.getAttribute('src')\n  if (src) {\n    var { cdn, library, revision } = parseStylesheetSource(src)\n  }\n  return {\n    library: element?.getContextAttribute('library'),\n    revision: element?.getAttribute('revision') ?? revision ?? 'published',\n    cdn: element?.getContextAttribute('cdn') ?? element?.getContextAttribute('hostname') ?? DEFAULT_CDN_URL\n  } as FEAASCDNStylesheetParams\n}\nexport type FEAASStylesheetProps = ReturnType<typeof FEAASStylesheetProps>\n\nexport class FEAASStylesheet extends FEAASBase<FEAASStylesheetProps, string> {\n  getProps() {\n    return FEAASStylesheetProps(this)\n  }\n\n  isReadyToLoad(): boolean {\n    return this.props.library != null && this.props.revision != null && this.props.cdn != null\n  }\n\n  onLoad = (html: string) => {\n    this.payload = html\n    this.advance()\n  }\n\n  load() {\n    return loadStylesheet(this.props, this.onLoad)\n  }\n}\n\ndeclare global {\n  namespace JSX {\n    interface IntrinsicElements {\n      'feaas-stylesheet': Partial<FEAASStylesheetProps> & { children?: any }\n    }\n  }\n}\nFEAASStylesheet.register('feaas-stylesheet')\nexport { FEAASStylesheet as Stylesheet }\n"],
  "mappings": "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",
  "names": ["headless_exports", "__export", "FEAASBase", "FEAASComponent", "FEAASComponentsProps", "DEFAULT_CDN_URL", "FEAASLoader", "FEAASLoaderProps", "FEAASStylesheet", "FEAASStylesheetProps", "JSONPath", "MyComponent", "autoloadScripts", "cleanCollectionBit", "clearFetchCache", "createStylesheet", "fetchAndRevalidate", "fetchAndRevalidateComponent", "fetchAndRevalidateStylesheet", "fetchBypassingCache", "fetchCache", "fetchComponent", "fetchToValidateCache", "fetchWithCacheAwareness", "findStylesheet", "getComponentSource", "getComponentURL", "getFetchCache", "getStylesheetSource", "getStylesheetURL", "loadScript", "loadStylesheet", "loadStylesheetAllowStale", "normalizeCollectionScope", "observeDOMElement", "parseComponentSource", "parseStylesheetSource", "queryScopes", "renderComponent", "renderComponentElement", "renderComponentPromise", "renderDOMContent", "renderDOMElement", "renderHTMLContent", "renderStylesheet", "renderStylesheetPromise", "serializeCH1RichText", "setDOMAttribute", "__toCommonJS", "ControlledPromise", "onSuccess", "onFailure", "e", "first", "restart", "resolve", "reject", "promise", "success", "failure", "value", "controlled", "WebComponent", "FEAASBase", "context", "ControlledPromise", "payload", "name", "oldValue", "newValue", "parent", "element", "_a", "args", "onlyFeaas", "p", "root", "el", "event", "target", "index", "_b", "error", "where", "handled", "e", "loaded", "flushSync", "React", "ReactDOM", "ReactDOMClient", "_c", "children", "r", "child", "displayName", "errorInfo", "props", "ErrorBoundary", "Wrapper", "value", "forceUpdateReact", "overrides", "property", "attribute", "path", "src", "hostname", "tagName", "win", "FEAASElement", "FEAASBase", "React", "ReactDOM", "MyComponent", "counter", "updates", "setUpdates", "u", "_typeof", "obj", "_classCallCheck", "instance", "Constructor", "_defineProperties", "target", "props", "i", "descriptor", "_createClass", "protoProps", "staticProps", "_inherits", "subClass", "superClass", "_setPrototypeOf", "_getPrototypeOf", "o", "p", "_isNativeReflectConstruct", "_construct", "Parent", "args", "Class", "_isNativeFunction", "fn", "_wrapNativeSuper", "_cache", "Wrapper", "_assertThisInitialized", "self", "_possibleConstructorReturn", "call", "_createSuper", "Derived", "hasNativeReflectConstruct", "Super", "result", "NewTarget", "_toConsumableArray", "arr", "_arrayWithoutHoles", "_iterableToArray", "_unsupportedIterableToArray", "_nonIterableSpread", "_arrayLikeToArray", "iter", "minLen", "n", "len", "arr2", "_createForOfIteratorHelper", "allowArrayLike", "it", "F", "e", "normalCompletion", "didErr", "err", "step", "hasOwnProp", "push", "item", "unshift", "NewError", "_Error", "_super", "value", "_this", "JSONPath", "opts", "expr", "callback", "otherTypeCallback", "optObj", "ret", "json", "_this2", "currParent", "currParentProperty", "flatten", "wrap", "_expr", "exprList", "ea", "rslt", "valOrPath", "resultType", "path", "fullRetObj", "type", "preferredOutput", "val", "parent", "parentPropName", "hasArrExpr", "literalPriority", "_this3", "retObj", "loc", "x", "addRet", "elems", "t", "m", "safeLoc", "addType", "valueType", "locProp", "parts", "_iterator", "_step", "part", "rett", "tmp", "tl", "tt", "f", "start", "end", "code", "_v", "_vname", "containsPath", "scriptCacheKey", "script", "pathArr", "pointer", "cache", "subx", "normalized", "$0", "$1", "prop", "ups", "exp", "match", "moveToAnotherArray", "source", "conditionCb", "il", "Script", "context", "keys", "funcs", "key", "values", "vr", "funcString", "s", "func", "fString", "lastStatementEnd", "cleanCollectionBit", "path", "normalizeCollectionScope", "queryScopes", "scopes", "datapath", "singleValue", "json", "keys", "b", "a", "scope", "collection", "JSONPath", "v", "i", "serializeCH1Tag", "data", "attrs", "tag", "k", "serializeCH1RichText", "level", "text", "mark", "_a", "HTMLNode", "nodeName", "nodeType", "textContent", "name", "value", "attr", "newNode", "referenceNode", "index", "attrName", "_a", "serializeHTML", "html", "parseHTML", "selector", "currentNode", "selectorMatchesNode", "selectors", "results", "checkNode", "node", "sel", "child", "step", "elementTypeOnly", "siblings", "i", "sibling", "deep", "clonedNode", "childNode", "clonedChild", "simpleSelectors", "simpleSelector", "attrSelectorMatch", "attrValue", "actualValue", "nodes", "stack", "openTagMatch", "closingTagMatch", "attrs", "_", "unescapeHTML", "parentNode", "textEnd", "textNode", "escapeHTML", "input", "attributes", "serializedAttributes", "serializedChildren", "observeDOMElement", "element", "observer", "changes", "change", "target", "src", "loadScript", "node", "autoloadScripts", "observe", "embeds", "i", "embed", "p", "scripts", "script", "getDOMCollectionIndex", "element", "datascope", "index", "p", "updateDOMClones", "targetCount", "config", "parentElement", "count", "last", "n", "i", "setDOMAttribute", "attribute", "value", "target", "serializeCH1RichText", "prop", "loadScript", "oldKeys", "_a", "property", "subvalue", "placeholder", "sortOrder", "renderDOMElement", "input", "datascopes", "isNested", "collection", "queryScopes", "_b", "normalizeCollectionScope", "attrs", "a", "b", "name", "datapath", "child", "isElement", "_c", "node", "renderDOMContent", "root", "template", "data", "newTemplate", "renderHTMLContent", "fakeDOM", "nodes", "parseHTML", "phases", "fetchCache", "clearFetchCache", "fetchAndRevalidate", "url", "options", "validator", "callback", "cache", "fetchWithCacheAwareness", "fetchToValidateCache", "result", "getFetchCache", "dontCreate", "key", "ControlledPromise", "phase", "date", "cachedRequest", "promise", "response", "isCached", "request", "head", "fetchBypassingCache", "DEFAULT_CDN_URL", "parseComponentSource", "source", "match", "cdn", "library", "component", "version", "revision", "getComponentSource", "props", "getStylesheetSource", "parseStylesheetSource", "parsed", "getComponentURL", "getStylesheetURL", "fetchAndRevalidateComponent", "callback", "dontRevalidate", "onlyIfNotDeleted", "response", "parseResponse", "results", "fetchWithCacheAwareness", "e", "result", "fetchToValidateCache", "fetchBypassingCache", "fetchComponent", "template", "fetchAndRevalidateStylesheet", "fetchAndRevalidate", "phase", "text", "renderStylesheet", "props", "style", "renderStylesheetPromise", "stylesheet", "fetchAndRevalidateStylesheet", "cssText", "phase", "loadStylesheet", "callback", "foundStylesheet", "findStylesheet", "createdStylesheet", "createStylesheet", "loadStylesheetAllowStale", "resolve", "reject", "getStylesheetURL", "url", "renderComponentElement", "content", "datasources", "wrapper", "fragment", "renderDOMElement", "renderComponent", "props", "root", "renderComponentPromise", "renderDOMContent", "fetchAndRevalidateComponent", "template", "FEAASComponentsProps", "element", "data", "src", "parsed", "parseComponentSource", "cdn", "library", "component", "version", "revision", "dataValue", "e", "_b", "_a", "DEFAULT_CDN_URL", "_c", "_d", "_f", "_e", "_h", "_g", "FEAASComponent", "FEAASBase", "name", "oldValue", "newValue", "html", "editor", "scope", "current", "last", "stylesheetPromise", "loadStylesheetAllowStale", "fetchAndRevalidateComponent", "c", "renderDOMElement", "renderDOMContent", "FEAASLoaderProps", "element", "FEAASLoader", "FEAASBase", "name", "oldValue", "newValue", "FEAASStylesheetProps", "element", "src", "cdn", "library", "revision", "parseStylesheetSource", "_b", "_a", "_d", "_c", "DEFAULT_CDN_URL", "FEAASStylesheet", "FEAASBase", "html", "loadStylesheet", "FEAASElement", "_a"]
}
